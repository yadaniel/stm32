ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"sdcard.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.SDCARD_Select,"ax",%progbits
  18              		.align	1
  19              		.arch armv7e-m
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  23              		.fpu fpv4-sp-d16
  25              	SDCARD_Select:
  26              	.LFB132:
  27              		.file 1 "./FW/sdcard.c"
   1:./FW/sdcard.c **** #include "sdcard.h"
   2:./FW/sdcard.c **** 
   3:./FW/sdcard.c **** static void SDCARD_Select() {
  28              		.loc 1 3 29 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32 0000 08B5     		push	{r3, lr}
  33              	.LCFI0:
  34              		.cfi_def_cfa_offset 8
  35              		.cfi_offset 3, -8
  36              		.cfi_offset 14, -4
   4:./FW/sdcard.c ****     HAL_GPIO_WritePin(SDCARD_CS_GPIO_Port, SDCARD_CS_Pin, GPIO_PIN_RESET);
  37              		.loc 1 4 5 view .LVU1
  38 0002 0022     		movs	r2, #0
  39 0004 1021     		movs	r1, #16
  40 0006 4FF09040 		mov	r0, #1207959552
  41 000a FFF7FEFF 		bl	HAL_GPIO_WritePin
  42              	.LVL0:
   5:./FW/sdcard.c **** }
  43              		.loc 1 5 1 is_stmt 0 view .LVU2
  44 000e 08BD     		pop	{r3, pc}
  45              		.cfi_endproc
  46              	.LFE132:
  48              		.section	.text.SDCARD_ReadR1,"ax",%progbits
  49              		.align	1
  50              		.syntax unified
  51              		.thumb
  52              		.thumb_func
  53              		.fpu fpv4-sp-d16
  55              	SDCARD_ReadR1:
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 2


  56              	.LFB134:
   6:./FW/sdcard.c **** 
   7:./FW/sdcard.c **** void SDCARD_Unselect() {
   8:./FW/sdcard.c ****     HAL_GPIO_WritePin(SDCARD_CS_GPIO_Port, SDCARD_CS_Pin, GPIO_PIN_SET);
   9:./FW/sdcard.c **** }
  10:./FW/sdcard.c **** 
  11:./FW/sdcard.c **** /*
  12:./FW/sdcard.c **** R1: 0abcdefg
  13:./FW/sdcard.c ****      ||||||`- 1th bit (g): card is in idle state
  14:./FW/sdcard.c ****      |||||`-- 2th bit (f): erase sequence cleared
  15:./FW/sdcard.c ****      ||||`--- 3th bit (e): illigal command detected
  16:./FW/sdcard.c ****      |||`---- 4th bit (d): crc check error
  17:./FW/sdcard.c ****      ||`----- 5th bit (c): error in the sequence of erase commands
  18:./FW/sdcard.c ****      |`------ 6th bit (b): misaligned addres used in command
  19:./FW/sdcard.c ****      `------- 7th bit (a): command argument outside allowed range
  20:./FW/sdcard.c ****              (8th bit is always zero)
  21:./FW/sdcard.c **** */
  22:./FW/sdcard.c **** static uint8_t SDCARD_ReadR1() {
  57              		.loc 1 22 32 is_stmt 1 view -0
  58              		.cfi_startproc
  59              		@ args = 0, pretend = 0, frame = 8
  60              		@ frame_needed = 0, uses_anonymous_args = 0
  61 0000 00B5     		push	{lr}
  62              	.LCFI1:
  63              		.cfi_def_cfa_offset 4
  64              		.cfi_offset 14, -4
  65 0002 85B0     		sub	sp, sp, #20
  66              	.LCFI2:
  67              		.cfi_def_cfa_offset 24
  23:./FW/sdcard.c ****     uint8_t r1;
  68              		.loc 1 23 5 view .LVU4
  24:./FW/sdcard.c ****     // make sure FF is transmitted during receive
  25:./FW/sdcard.c ****     uint8_t tx = 0xFF;
  69              		.loc 1 25 5 view .LVU5
  70              		.loc 1 25 13 is_stmt 0 view .LVU6
  71 0004 FF23     		movs	r3, #255
  72 0006 8DF80E30 		strb	r3, [sp, #14]
  73              	.L4:
  26:./FW/sdcard.c ****     for(;;) {
  74              		.loc 1 26 5 is_stmt 1 view .LVU7
  27:./FW/sdcard.c ****         HAL_SPI_TransmitReceive(&SDCARD_SPI_PORT, &tx, &r1, sizeof(r1), HAL_MAX_DELAY);
  75              		.loc 1 27 9 view .LVU8
  76 000a 4FF0FF33 		mov	r3, #-1
  77 000e 0093     		str	r3, [sp]
  78 0010 0123     		movs	r3, #1
  79 0012 0DF10F02 		add	r2, sp, #15
  80 0016 0DF10E01 		add	r1, sp, #14
  81 001a 0648     		ldr	r0, .L6
  82 001c FFF7FEFF 		bl	HAL_SPI_TransmitReceive
  83              	.LVL1:
  28:./FW/sdcard.c ****         if((r1 & 0x80) == 0) // 8th bit alwyas zero, r1 recevied
  84              		.loc 1 28 9 view .LVU9
  85              		.loc 1 28 24 is_stmt 0 view .LVU10
  86 0020 9DF80F00 		ldrb	r0, [sp, #15]	@ zero_extendqisi2
  87 0024 9DF90F30 		ldrsb	r3, [sp, #15]
  88              		.loc 1 28 11 view .LVU11
  89 0028 002B     		cmp	r3, #0
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 3


  90 002a EEDB     		blt	.L4
  29:./FW/sdcard.c ****         { break; }
  30:./FW/sdcard.c ****     }
  31:./FW/sdcard.c ****     return r1;
  32:./FW/sdcard.c **** }
  91              		.loc 1 32 1 view .LVU12
  92 002c 05B0     		add	sp, sp, #20
  93              	.LCFI3:
  94              		.cfi_def_cfa_offset 4
  95              		@ sp needed
  96 002e 5DF804FB 		ldr	pc, [sp], #4
  97              	.L7:
  98 0032 00BF     		.align	2
  99              	.L6:
 100 0034 00000000 		.word	hspi1
 101              		.cfi_endproc
 102              	.LFE134:
 104              		.section	.text.SDCARD_ReadBytes,"ax",%progbits
 105              		.align	1
 106              		.syntax unified
 107              		.thumb
 108              		.thumb_func
 109              		.fpu fpv4-sp-d16
 111              	SDCARD_ReadBytes:
 112              	.LVL2:
 113              	.LFB136:
  33:./FW/sdcard.c **** 
  34:./FW/sdcard.c **** // data token for CMD9, CMD17, CMD18 and CMD24 are the same
  35:./FW/sdcard.c **** #define DATA_TOKEN_CMD9  0xFE
  36:./FW/sdcard.c **** #define DATA_TOKEN_CMD17 0xFE
  37:./FW/sdcard.c **** #define DATA_TOKEN_CMD18 0xFE
  38:./FW/sdcard.c **** #define DATA_TOKEN_CMD24 0xFE
  39:./FW/sdcard.c **** #define DATA_TOKEN_CMD25 0xFC
  40:./FW/sdcard.c **** 
  41:./FW/sdcard.c **** static int SDCARD_WaitDataToken(uint8_t token) {
  42:./FW/sdcard.c ****     uint8_t fb;
  43:./FW/sdcard.c ****     // make sure FF is transmitted during receive
  44:./FW/sdcard.c ****     uint8_t tx = 0xFF;
  45:./FW/sdcard.c ****     for(;;) {
  46:./FW/sdcard.c ****         HAL_SPI_TransmitReceive(&SDCARD_SPI_PORT, &tx, &fb, sizeof(fb), HAL_MAX_DELAY);
  47:./FW/sdcard.c ****         if(fb == token)
  48:./FW/sdcard.c ****         { break; }
  49:./FW/sdcard.c **** 
  50:./FW/sdcard.c ****         if(fb != 0xFF)
  51:./FW/sdcard.c ****         { return -1; }
  52:./FW/sdcard.c ****     }
  53:./FW/sdcard.c ****     return 0;
  54:./FW/sdcard.c **** }
  55:./FW/sdcard.c **** 
  56:./FW/sdcard.c **** static int SDCARD_ReadBytes(uint8_t* buff, size_t buff_size) {
 114              		.loc 1 56 62 is_stmt 1 view -0
 115              		.cfi_startproc
 116              		@ args = 0, pretend = 0, frame = 8
 117              		@ frame_needed = 0, uses_anonymous_args = 0
 118              		.loc 1 56 62 is_stmt 0 view .LVU14
 119 0000 30B5     		push	{r4, r5, lr}
 120              	.LCFI4:
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 4


 121              		.cfi_def_cfa_offset 12
 122              		.cfi_offset 4, -12
 123              		.cfi_offset 5, -8
 124              		.cfi_offset 14, -4
 125 0002 85B0     		sub	sp, sp, #20
 126              	.LCFI5:
 127              		.cfi_def_cfa_offset 32
 128 0004 0546     		mov	r5, r0
 129 0006 0C46     		mov	r4, r1
  57:./FW/sdcard.c ****     // make sure FF is transmitted during receive
  58:./FW/sdcard.c ****     uint8_t tx = 0xFF;
 130              		.loc 1 58 5 is_stmt 1 view .LVU15
 131              		.loc 1 58 13 is_stmt 0 view .LVU16
 132 0008 FF23     		movs	r3, #255
 133 000a 8DF80F30 		strb	r3, [sp, #15]
  59:./FW/sdcard.c ****     while(buff_size > 0) {
 134              		.loc 1 59 5 is_stmt 1 view .LVU17
 135              	.LVL3:
 136              	.L9:
 137              		.loc 1 59 10 view .LVU18
 138 000e 64B1     		cbz	r4, .L12
  60:./FW/sdcard.c ****         HAL_SPI_TransmitReceive(&SDCARD_SPI_PORT, &tx, buff, 1, HAL_MAX_DELAY);
 139              		.loc 1 60 9 view .LVU19
 140 0010 4FF0FF33 		mov	r3, #-1
 141 0014 0093     		str	r3, [sp]
 142 0016 0123     		movs	r3, #1
 143 0018 2A46     		mov	r2, r5
 144 001a 0DF10F01 		add	r1, sp, #15
 145 001e 0448     		ldr	r0, .L13
 146 0020 FFF7FEFF 		bl	HAL_SPI_TransmitReceive
 147              	.LVL4:
  61:./FW/sdcard.c ****         buff++;
 148              		.loc 1 61 9 view .LVU20
 149              		.loc 1 61 13 is_stmt 0 view .LVU21
 150 0024 0135     		adds	r5, r5, #1
 151              	.LVL5:
  62:./FW/sdcard.c ****         buff_size--;
 152              		.loc 1 62 9 is_stmt 1 view .LVU22
 153              		.loc 1 62 18 is_stmt 0 view .LVU23
 154 0026 013C     		subs	r4, r4, #1
 155              	.LVL6:
 156              		.loc 1 62 18 view .LVU24
 157 0028 F1E7     		b	.L9
 158              	.L12:
  63:./FW/sdcard.c ****     }
  64:./FW/sdcard.c **** 
  65:./FW/sdcard.c ****     return 0;
 159              		.loc 1 65 5 is_stmt 1 view .LVU25
  66:./FW/sdcard.c **** }
 160              		.loc 1 66 1 is_stmt 0 view .LVU26
 161 002a 0020     		movs	r0, #0
 162 002c 05B0     		add	sp, sp, #20
 163              	.LCFI6:
 164              		.cfi_def_cfa_offset 12
 165              		@ sp needed
 166 002e 30BD     		pop	{r4, r5, pc}
 167              	.LVL7:
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 5


 168              	.L14:
 169              		.loc 1 66 1 view .LVU27
 170              		.align	2
 171              	.L13:
 172 0030 00000000 		.word	hspi1
 173              		.cfi_endproc
 174              	.LFE136:
 176              		.section	.text.SDCARD_WaitNotBusy,"ax",%progbits
 177              		.align	1
 178              		.syntax unified
 179              		.thumb
 180              		.thumb_func
 181              		.fpu fpv4-sp-d16
 183              	SDCARD_WaitNotBusy:
 184              	.LFB137:
  67:./FW/sdcard.c **** 
  68:./FW/sdcard.c **** static int SDCARD_WaitNotBusy() {
 185              		.loc 1 68 33 is_stmt 1 view -0
 186              		.cfi_startproc
 187              		@ args = 0, pretend = 0, frame = 8
 188              		@ frame_needed = 0, uses_anonymous_args = 0
 189 0000 00B5     		push	{lr}
 190              	.LCFI7:
 191              		.cfi_def_cfa_offset 4
 192              		.cfi_offset 14, -4
 193 0002 83B0     		sub	sp, sp, #12
 194              	.LCFI8:
 195              		.cfi_def_cfa_offset 16
 196              	.L17:
  69:./FW/sdcard.c ****     uint8_t busy;
 197              		.loc 1 69 5 view .LVU29
  70:./FW/sdcard.c ****     do {
 198              		.loc 1 70 5 view .LVU30
  71:./FW/sdcard.c ****         if(SDCARD_ReadBytes(&busy, sizeof(busy)) < 0) {
 199              		.loc 1 71 9 view .LVU31
 200              		.loc 1 71 12 is_stmt 0 view .LVU32
 201 0004 0121     		movs	r1, #1
 202 0006 0DF10700 		add	r0, sp, #7
 203 000a FFF7FEFF 		bl	SDCARD_ReadBytes
 204              	.LVL8:
 205              		.loc 1 71 11 view .LVU33
 206 000e 0028     		cmp	r0, #0
 207 0010 05DB     		blt	.L18
  72:./FW/sdcard.c ****             return -1;
  73:./FW/sdcard.c ****         }
  74:./FW/sdcard.c ****     } while(busy != 0xFF);
 208              		.loc 1 74 12 is_stmt 1 view .LVU34
 209              		.loc 1 74 18 is_stmt 0 view .LVU35
 210 0012 9DF80730 		ldrb	r3, [sp, #7]	@ zero_extendqisi2
 211              		.loc 1 74 5 view .LVU36
 212 0016 FF2B     		cmp	r3, #255
 213 0018 F4D1     		bne	.L17
  75:./FW/sdcard.c **** 
  76:./FW/sdcard.c ****     return 0;
 214              		.loc 1 76 12 view .LVU37
 215 001a 0020     		movs	r0, #0
 216 001c 01E0     		b	.L15
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 6


 217              	.L18:
  72:./FW/sdcard.c ****             return -1;
 218              		.loc 1 72 20 view .LVU38
 219 001e 4FF0FF30 		mov	r0, #-1
 220              	.L15:
  77:./FW/sdcard.c **** }
 221              		.loc 1 77 1 view .LVU39
 222 0022 03B0     		add	sp, sp, #12
 223              	.LCFI9:
 224              		.cfi_def_cfa_offset 4
 225              		@ sp needed
 226 0024 5DF804FB 		ldr	pc, [sp], #4
 227              		.cfi_endproc
 228              	.LFE137:
 230              		.section	.text.SDCARD_WaitDataToken,"ax",%progbits
 231              		.align	1
 232              		.syntax unified
 233              		.thumb
 234              		.thumb_func
 235              		.fpu fpv4-sp-d16
 237              	SDCARD_WaitDataToken:
 238              	.LVL9:
 239              	.LFB135:
  41:./FW/sdcard.c ****     uint8_t fb;
 240              		.loc 1 41 48 is_stmt 1 view -0
 241              		.cfi_startproc
 242              		@ args = 0, pretend = 0, frame = 8
 243              		@ frame_needed = 0, uses_anonymous_args = 0
  41:./FW/sdcard.c ****     uint8_t fb;
 244              		.loc 1 41 48 is_stmt 0 view .LVU41
 245 0000 10B5     		push	{r4, lr}
 246              	.LCFI10:
 247              		.cfi_def_cfa_offset 8
 248              		.cfi_offset 4, -8
 249              		.cfi_offset 14, -4
 250 0002 84B0     		sub	sp, sp, #16
 251              	.LCFI11:
 252              		.cfi_def_cfa_offset 24
 253 0004 0446     		mov	r4, r0
  42:./FW/sdcard.c ****     // make sure FF is transmitted during receive
 254              		.loc 1 42 5 is_stmt 1 view .LVU42
  44:./FW/sdcard.c ****     for(;;) {
 255              		.loc 1 44 5 view .LVU43
  44:./FW/sdcard.c ****     for(;;) {
 256              		.loc 1 44 13 is_stmt 0 view .LVU44
 257 0006 FF23     		movs	r3, #255
 258 0008 8DF80E30 		strb	r3, [sp, #14]
 259              	.LVL10:
 260              	.L22:
  45:./FW/sdcard.c ****         HAL_SPI_TransmitReceive(&SDCARD_SPI_PORT, &tx, &fb, sizeof(fb), HAL_MAX_DELAY);
 261              		.loc 1 45 5 is_stmt 1 view .LVU45
  46:./FW/sdcard.c ****         if(fb == token)
 262              		.loc 1 46 9 view .LVU46
 263 000c 4FF0FF33 		mov	r3, #-1
 264 0010 0093     		str	r3, [sp]
 265 0012 0123     		movs	r3, #1
 266 0014 0DF10F02 		add	r2, sp, #15
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 7


 267 0018 0DF10E01 		add	r1, sp, #14
 268 001c 0748     		ldr	r0, .L25
 269 001e FFF7FEFF 		bl	HAL_SPI_TransmitReceive
 270              	.LVL11:
  47:./FW/sdcard.c ****         { break; }
 271              		.loc 1 47 9 view .LVU47
  47:./FW/sdcard.c ****         { break; }
 272              		.loc 1 47 15 is_stmt 0 view .LVU48
 273 0022 9DF80F30 		ldrb	r3, [sp, #15]	@ zero_extendqisi2
  47:./FW/sdcard.c ****         { break; }
 274              		.loc 1 47 11 view .LVU49
 275 0026 A342     		cmp	r3, r4
 276 0028 04D0     		beq	.L23
  50:./FW/sdcard.c ****         { return -1; }
 277              		.loc 1 50 9 is_stmt 1 view .LVU50
  50:./FW/sdcard.c ****         { return -1; }
 278              		.loc 1 50 11 is_stmt 0 view .LVU51
 279 002a FF2B     		cmp	r3, #255
 280 002c EED0     		beq	.L22
  51:./FW/sdcard.c ****     }
 281              		.loc 1 51 18 view .LVU52
 282 002e 4FF0FF30 		mov	r0, #-1
 283 0032 00E0     		b	.L20
 284              	.L23:
  53:./FW/sdcard.c **** }
 285              		.loc 1 53 12 view .LVU53
 286 0034 0020     		movs	r0, #0
 287              	.L20:
  54:./FW/sdcard.c **** 
 288              		.loc 1 54 1 view .LVU54
 289 0036 04B0     		add	sp, sp, #16
 290              	.LCFI12:
 291              		.cfi_def_cfa_offset 8
 292              		@ sp needed
 293 0038 10BD     		pop	{r4, pc}
 294              	.L26:
 295 003a 00BF     		.align	2
 296              	.L25:
 297 003c 00000000 		.word	hspi1
 298              		.cfi_endproc
 299              	.LFE135:
 301              		.section	.text.SDCARD_Unselect,"ax",%progbits
 302              		.align	1
 303              		.global	SDCARD_Unselect
 304              		.syntax unified
 305              		.thumb
 306              		.thumb_func
 307              		.fpu fpv4-sp-d16
 309              	SDCARD_Unselect:
 310              	.LFB133:
   7:./FW/sdcard.c ****     HAL_GPIO_WritePin(SDCARD_CS_GPIO_Port, SDCARD_CS_Pin, GPIO_PIN_SET);
 311              		.loc 1 7 24 is_stmt 1 view -0
 312              		.cfi_startproc
 313              		@ args = 0, pretend = 0, frame = 0
 314              		@ frame_needed = 0, uses_anonymous_args = 0
 315 0000 08B5     		push	{r3, lr}
 316              	.LCFI13:
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 8


 317              		.cfi_def_cfa_offset 8
 318              		.cfi_offset 3, -8
 319              		.cfi_offset 14, -4
   8:./FW/sdcard.c **** }
 320              		.loc 1 8 5 view .LVU56
 321 0002 0122     		movs	r2, #1
 322 0004 1021     		movs	r1, #16
 323 0006 4FF09040 		mov	r0, #1207959552
 324 000a FFF7FEFF 		bl	HAL_GPIO_WritePin
 325              	.LVL12:
   9:./FW/sdcard.c **** 
 326              		.loc 1 9 1 is_stmt 0 view .LVU57
 327 000e 08BD     		pop	{r3, pc}
 328              		.cfi_endproc
 329              	.LFE133:
 331              		.section	.text.SDCARD_Init,"ax",%progbits
 332              		.align	1
 333              		.global	SDCARD_Init
 334              		.syntax unified
 335              		.thumb
 336              		.thumb_func
 337              		.fpu fpv4-sp-d16
 339              	SDCARD_Init:
 340              	.LFB138:
  78:./FW/sdcard.c **** 
  79:./FW/sdcard.c **** int SDCARD_Init() {
 341              		.loc 1 79 19 is_stmt 1 view -0
 342              		.cfi_startproc
 343              		@ args = 0, pretend = 0, frame = 8
 344              		@ frame_needed = 0, uses_anonymous_args = 0
 345 0000 10B5     		push	{r4, lr}
 346              	.LCFI14:
 347              		.cfi_def_cfa_offset 8
 348              		.cfi_offset 4, -8
 349              		.cfi_offset 14, -4
 350 0002 82B0     		sub	sp, sp, #8
 351              	.LCFI15:
 352              		.cfi_def_cfa_offset 16
  80:./FW/sdcard.c ****     /*
  81:./FW/sdcard.c ****     Step 1.
  82:./FW/sdcard.c ****     Set DI and CS high and apply 74 or more clock pulses to SCLK. Without this
  83:./FW/sdcard.c ****     step under certain circumstances SD-card will not work. For instance, when
  84:./FW/sdcard.c ****     multiple SPI devices are sharing the same bus (i.e. MISO, MOSI, CS).
  85:./FW/sdcard.c ****     */
  86:./FW/sdcard.c ****     SDCARD_Unselect();
 353              		.loc 1 86 5 view .LVU59
 354 0004 FFF7FEFF 		bl	SDCARD_Unselect
 355              	.LVL13:
  87:./FW/sdcard.c **** 
  88:./FW/sdcard.c ****     uint8_t high = 0xFF;
 356              		.loc 1 88 5 view .LVU60
 357              		.loc 1 88 13 is_stmt 0 view .LVU61
 358 0008 FF23     		movs	r3, #255
 359 000a 8DF80730 		strb	r3, [sp, #7]
  89:./FW/sdcard.c ****     for(int i = 0; i < 10; i++) { // 80 clock pulses
 360              		.loc 1 89 5 is_stmt 1 view .LVU62
 361              	.LBB2:
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 9


 362              		.loc 1 89 9 view .LVU63
 363              	.LVL14:
 364              		.loc 1 89 13 is_stmt 0 view .LVU64
 365 000e 0024     		movs	r4, #0
 366              	.LVL15:
 367              	.L30:
 368              		.loc 1 89 20 is_stmt 1 discriminator 1 view .LVU65
 369              		.loc 1 89 5 is_stmt 0 discriminator 1 view .LVU66
 370 0010 092C     		cmp	r4, #9
 371 0012 09DC     		bgt	.L52
  90:./FW/sdcard.c ****         HAL_SPI_Transmit(&SDCARD_SPI_PORT, &high, sizeof(high), HAL_MAX_DELAY);
 372              		.loc 1 90 9 is_stmt 1 discriminator 3 view .LVU67
 373 0014 4FF0FF33 		mov	r3, #-1
 374 0018 0122     		movs	r2, #1
 375 001a 0DF10701 		add	r1, sp, #7
 376 001e 5C48     		ldr	r0, .L64
 377 0020 FFF7FEFF 		bl	HAL_SPI_Transmit
 378              	.LVL16:
  89:./FW/sdcard.c ****     for(int i = 0; i < 10; i++) { // 80 clock pulses
 379              		.loc 1 89 28 discriminator 3 view .LVU68
  89:./FW/sdcard.c ****     for(int i = 0; i < 10; i++) { // 80 clock pulses
 380              		.loc 1 89 29 is_stmt 0 discriminator 3 view .LVU69
 381 0024 0134     		adds	r4, r4, #1
 382              	.LVL17:
  89:./FW/sdcard.c ****     for(int i = 0; i < 10; i++) { // 80 clock pulses
 383              		.loc 1 89 29 discriminator 3 view .LVU70
 384 0026 F3E7     		b	.L30
 385              	.L52:
  89:./FW/sdcard.c ****     for(int i = 0; i < 10; i++) { // 80 clock pulses
 386              		.loc 1 89 29 discriminator 3 view .LVU71
 387              	.LBE2:
  91:./FW/sdcard.c ****     }
  92:./FW/sdcard.c **** 
  93:./FW/sdcard.c ****     SDCARD_Select();
 388              		.loc 1 93 5 is_stmt 1 view .LVU72
 389 0028 FFF7FEFF 		bl	SDCARD_Select
 390              	.LVL18:
  94:./FW/sdcard.c **** 
  95:./FW/sdcard.c ****     /*
  96:./FW/sdcard.c ****     Step 2.
  97:./FW/sdcard.c **** 
  98:./FW/sdcard.c ****     Send CMD0 (GO_IDLE_STATE): Reset the SD card.
  99:./FW/sdcard.c ****     */
 100:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) { // keep this!
 391              		.loc 1 100 5 view .LVU73
 392              		.loc 1 100 8 is_stmt 0 view .LVU74
 393 002c FFF7FEFF 		bl	SDCARD_WaitNotBusy
 394              	.LVL19:
 395              		.loc 1 100 7 view .LVU75
 396 0030 0028     		cmp	r0, #0
 397 0032 2EDB     		blt	.L53
 398              	.LBB3:
 101:./FW/sdcard.c ****         SDCARD_Unselect();
 102:./FW/sdcard.c ****         return -1;
 103:./FW/sdcard.c ****     }
 104:./FW/sdcard.c **** 
 105:./FW/sdcard.c ****     {
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 10


 106:./FW/sdcard.c ****         static const uint8_t cmd[] =
 399              		.loc 1 106 9 is_stmt 1 view .LVU76
 107:./FW/sdcard.c ****         { 0x40 | 0x00 /* CMD0 */, 0x00, 0x00, 0x00, 0x00 /* ARG = 0 */, (0x4A << 1) | 1 /* CRC7 + e
 108:./FW/sdcard.c ****         HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 400              		.loc 1 108 9 view .LVU77
 401 0034 4FF0FF33 		mov	r3, #-1
 402 0038 0622     		movs	r2, #6
 403 003a 5649     		ldr	r1, .L64+4
 404 003c 5448     		ldr	r0, .L64
 405 003e FFF7FEFF 		bl	HAL_SPI_Transmit
 406              	.LVL20:
 407              	.LBE3:
 109:./FW/sdcard.c ****     }
 110:./FW/sdcard.c **** 
 111:./FW/sdcard.c ****     if(SDCARD_ReadR1() != 0x01) {
 408              		.loc 1 111 5 view .LVU78
 409              		.loc 1 111 8 is_stmt 0 view .LVU79
 410 0042 FFF7FEFF 		bl	SDCARD_ReadR1
 411              	.LVL21:
 412              		.loc 1 111 7 view .LVU80
 413 0046 0128     		cmp	r0, #1
 414 0048 28D1     		bne	.L54
 112:./FW/sdcard.c ****         SDCARD_Unselect();
 113:./FW/sdcard.c ****         return -1;
 114:./FW/sdcard.c ****     }
 115:./FW/sdcard.c **** 
 116:./FW/sdcard.c ****     /*
 117:./FW/sdcard.c ****     Step 3.
 118:./FW/sdcard.c ****     After the card enters idle state with a CMD0, send a CMD8 with argument of
 119:./FW/sdcard.c ****     0x000001AA and correct CRC prior to initialization process. If the CMD8 is
 120:./FW/sdcard.c ****     rejected with illigal command error (0x05), the card is SDC version 1 or
 121:./FW/sdcard.c ****     MMC version 3. If accepted, R7 response (R1(0x01) + 32-bit return value)
 122:./FW/sdcard.c ****     will be returned. The lower 12 bits in the return value 0x1AA means that
 123:./FW/sdcard.c ****     the card is SDC version 2 and it can work at voltage range of 2.7 to 3.6
 124:./FW/sdcard.c ****     volts. If not the case, the card should be rejected.
 125:./FW/sdcard.c ****     */
 126:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) { // keep this!
 415              		.loc 1 126 5 is_stmt 1 view .LVU81
 416              		.loc 1 126 8 is_stmt 0 view .LVU82
 417 004a FFF7FEFF 		bl	SDCARD_WaitNotBusy
 418              	.LVL22:
 419              		.loc 1 126 7 view .LVU83
 420 004e 0028     		cmp	r0, #0
 421 0050 29DB     		blt	.L55
 422              	.LBB4:
 127:./FW/sdcard.c ****         SDCARD_Unselect();
 128:./FW/sdcard.c ****         return -1;
 129:./FW/sdcard.c ****     }
 130:./FW/sdcard.c **** 
 131:./FW/sdcard.c ****     {
 132:./FW/sdcard.c ****         static const uint8_t cmd[] =
 423              		.loc 1 132 9 is_stmt 1 view .LVU84
 133:./FW/sdcard.c ****         { 0x40 | 0x08 /* CMD8 */, 0x00, 0x00, 0x01, 0xAA /* ARG */, (0x43 << 1) | 1 /* CRC7 + end b
 134:./FW/sdcard.c ****         HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 424              		.loc 1 134 9 view .LVU85
 425 0052 4FF0FF33 		mov	r3, #-1
 426 0056 0622     		movs	r2, #6
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 11


 427 0058 4F49     		ldr	r1, .L64+8
 428 005a 4D48     		ldr	r0, .L64
 429 005c FFF7FEFF 		bl	HAL_SPI_Transmit
 430              	.LVL23:
 431              	.LBE4:
 135:./FW/sdcard.c ****     }
 136:./FW/sdcard.c **** 
 137:./FW/sdcard.c ****     if(SDCARD_ReadR1() != 0x01) {
 432              		.loc 1 137 5 view .LVU86
 433              		.loc 1 137 8 is_stmt 0 view .LVU87
 434 0060 FFF7FEFF 		bl	SDCARD_ReadR1
 435              	.LVL24:
 436              		.loc 1 137 7 view .LVU88
 437 0064 0128     		cmp	r0, #1
 438 0066 23D1     		bne	.L56
 439              	.LBB5:
 138:./FW/sdcard.c ****         SDCARD_Unselect();
 139:./FW/sdcard.c ****         return -2; // not an SDHC/SDXC card (i.e. SDSC, not supported)
 140:./FW/sdcard.c ****     }
 141:./FW/sdcard.c **** 
 142:./FW/sdcard.c ****     {
 143:./FW/sdcard.c ****         uint8_t resp[4];
 440              		.loc 1 143 9 is_stmt 1 view .LVU89
 144:./FW/sdcard.c ****         if(SDCARD_ReadBytes(resp, sizeof(resp)) < 0) {
 441              		.loc 1 144 9 view .LVU90
 442              		.loc 1 144 12 is_stmt 0 view .LVU91
 443 0068 0421     		movs	r1, #4
 444 006a 6846     		mov	r0, sp
 445 006c FFF7FEFF 		bl	SDCARD_ReadBytes
 446              	.LVL25:
 447              		.loc 1 144 11 view .LVU92
 448 0070 0028     		cmp	r0, #0
 449 0072 22DB     		blt	.L57
 145:./FW/sdcard.c ****             SDCARD_Unselect();
 146:./FW/sdcard.c ****             return -3;
 147:./FW/sdcard.c ****         }
 148:./FW/sdcard.c **** 
 149:./FW/sdcard.c ****         if(((resp[2] & 0x01) != 1) || (resp[3] != 0xAA)) {
 450              		.loc 1 149 9 is_stmt 1 view .LVU93
 451              		.loc 1 149 18 is_stmt 0 view .LVU94
 452 0074 9DF80230 		ldrb	r3, [sp, #2]	@ zero_extendqisi2
 453              		.loc 1 149 11 view .LVU95
 454 0078 13F0010F 		tst	r3, #1
 455 007c 03D0     		beq	.L39
 456              		.loc 1 149 44 discriminator 1 view .LVU96
 457 007e 9DF80330 		ldrb	r3, [sp, #3]	@ zero_extendqisi2
 458              		.loc 1 149 36 discriminator 1 view .LVU97
 459 0082 AA2B     		cmp	r3, #170
 460 0084 1ED0     		beq	.L41
 461              	.L39:
 150:./FW/sdcard.c ****             SDCARD_Unselect();
 462              		.loc 1 150 13 is_stmt 1 view .LVU98
 463 0086 FFF7FEFF 		bl	SDCARD_Unselect
 464              	.LVL26:
 151:./FW/sdcard.c ****             return -4;
 465              		.loc 1 151 13 view .LVU99
 466              		.loc 1 151 20 is_stmt 0 view .LVU100
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 12


 467 008a 6FF00300 		mvn	r0, #3
 468              	.L29:
 469              	.LBE5:
 152:./FW/sdcard.c ****         }
 153:./FW/sdcard.c ****     }
 154:./FW/sdcard.c **** 
 155:./FW/sdcard.c ****     /*
 156:./FW/sdcard.c ****     Step 4.
 157:./FW/sdcard.c ****     And then initiate initialization with ACMD41 with HCS flag (bit 30).
 158:./FW/sdcard.c ****     */
 159:./FW/sdcard.c ****     for(;;) {
 160:./FW/sdcard.c ****         if(SDCARD_WaitNotBusy() < 0) { // keep this!
 161:./FW/sdcard.c ****             SDCARD_Unselect();
 162:./FW/sdcard.c ****             return -1;
 163:./FW/sdcard.c ****         }
 164:./FW/sdcard.c **** 
 165:./FW/sdcard.c ****         {
 166:./FW/sdcard.c ****             static const uint8_t cmd[] =
 167:./FW/sdcard.c ****             { 0x40 | 0x37 /* CMD55 */, 0x00, 0x00, 0x00, 0x00 /* ARG */, (0x7F << 1) | 1 /* CRC7 + 
 168:./FW/sdcard.c ****             HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 169:./FW/sdcard.c ****         }
 170:./FW/sdcard.c **** 
 171:./FW/sdcard.c ****         if(SDCARD_ReadR1() != 0x01) {
 172:./FW/sdcard.c ****             SDCARD_Unselect();
 173:./FW/sdcard.c ****             return -5;
 174:./FW/sdcard.c ****         }
 175:./FW/sdcard.c **** 
 176:./FW/sdcard.c ****         if(SDCARD_WaitNotBusy() < 0) { // keep this!
 177:./FW/sdcard.c ****             SDCARD_Unselect();
 178:./FW/sdcard.c ****             return -1;
 179:./FW/sdcard.c ****         }
 180:./FW/sdcard.c **** 
 181:./FW/sdcard.c ****         {
 182:./FW/sdcard.c ****             static const uint8_t cmd[] =
 183:./FW/sdcard.c ****             { 0x40 | 0x29 /* ACMD41 */, 0x40, 0x00, 0x00, 0x00 /* ARG */, (0x7F << 1) | 1 /* CRC7 +
 184:./FW/sdcard.c ****             HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 185:./FW/sdcard.c ****         }
 186:./FW/sdcard.c **** 
 187:./FW/sdcard.c ****         uint8_t r1 = SDCARD_ReadR1();
 188:./FW/sdcard.c ****         if(r1 == 0x00) {
 189:./FW/sdcard.c ****             break;
 190:./FW/sdcard.c ****         }
 191:./FW/sdcard.c **** 
 192:./FW/sdcard.c ****         if(r1 != 0x01) {
 193:./FW/sdcard.c ****             SDCARD_Unselect();
 194:./FW/sdcard.c ****             return -6;
 195:./FW/sdcard.c ****         }
 196:./FW/sdcard.c ****     }
 197:./FW/sdcard.c **** 
 198:./FW/sdcard.c ****     /*
 199:./FW/sdcard.c ****     Step 5.
 200:./FW/sdcard.c ****     After the initialization completed, read OCR register with CMD58 and check
 201:./FW/sdcard.c ****     CCS flag (bit 30). When it is set, the card is a high-capacity card known
 202:./FW/sdcard.c ****     as SDHC/SDXC.
 203:./FW/sdcard.c ****     */
 204:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) { // keep this!
 205:./FW/sdcard.c ****         SDCARD_Unselect();
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 13


 206:./FW/sdcard.c ****         return -1;
 207:./FW/sdcard.c ****     }
 208:./FW/sdcard.c **** 
 209:./FW/sdcard.c ****     {
 210:./FW/sdcard.c ****         static const uint8_t cmd[] =
 211:./FW/sdcard.c ****         { 0x40 | 0x3A /* CMD58 */, 0x00, 0x00, 0x00, 0x00 /* ARG */, (0x7F << 1) | 1 /* CRC7 + end 
 212:./FW/sdcard.c ****         HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 213:./FW/sdcard.c ****     }
 214:./FW/sdcard.c **** 
 215:./FW/sdcard.c ****     if(SDCARD_ReadR1() != 0x00) {
 216:./FW/sdcard.c ****         SDCARD_Unselect();
 217:./FW/sdcard.c ****         return -7;
 218:./FW/sdcard.c ****     }
 219:./FW/sdcard.c **** 
 220:./FW/sdcard.c ****     {
 221:./FW/sdcard.c ****         uint8_t resp[4];
 222:./FW/sdcard.c ****         if(SDCARD_ReadBytes(resp, sizeof(resp)) < 0) {
 223:./FW/sdcard.c ****             SDCARD_Unselect();
 224:./FW/sdcard.c ****             return -8;
 225:./FW/sdcard.c ****         }
 226:./FW/sdcard.c **** 
 227:./FW/sdcard.c ****         if((resp[0] & 0xC0) != 0xC0) {
 228:./FW/sdcard.c ****             SDCARD_Unselect();
 229:./FW/sdcard.c ****             return -9;
 230:./FW/sdcard.c ****         }
 231:./FW/sdcard.c ****     }
 232:./FW/sdcard.c **** 
 233:./FW/sdcard.c ****     SDCARD_Unselect();
 234:./FW/sdcard.c ****     return 0;
 235:./FW/sdcard.c **** }
 470              		.loc 1 235 1 view .LVU101
 471 008e 02B0     		add	sp, sp, #8
 472              	.LCFI16:
 473              		.cfi_remember_state
 474              		.cfi_def_cfa_offset 8
 475              		@ sp needed
 476 0090 10BD     		pop	{r4, pc}
 477              	.LVL27:
 478              	.L53:
 479              	.LCFI17:
 480              		.cfi_restore_state
 101:./FW/sdcard.c ****         return -1;
 481              		.loc 1 101 9 is_stmt 1 view .LVU102
 482 0092 FFF7FEFF 		bl	SDCARD_Unselect
 483              	.LVL28:
 102:./FW/sdcard.c ****     }
 484              		.loc 1 102 9 view .LVU103
 102:./FW/sdcard.c ****     }
 485              		.loc 1 102 16 is_stmt 0 view .LVU104
 486 0096 4FF0FF30 		mov	r0, #-1
 487 009a F8E7     		b	.L29
 488              	.L54:
 112:./FW/sdcard.c ****         return -1;
 489              		.loc 1 112 9 is_stmt 1 view .LVU105
 490 009c FFF7FEFF 		bl	SDCARD_Unselect
 491              	.LVL29:
 113:./FW/sdcard.c ****     }
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 14


 492              		.loc 1 113 9 view .LVU106
 113:./FW/sdcard.c ****     }
 493              		.loc 1 113 16 is_stmt 0 view .LVU107
 494 00a0 4FF0FF30 		mov	r0, #-1
 495 00a4 F3E7     		b	.L29
 496              	.L55:
 127:./FW/sdcard.c ****         return -1;
 497              		.loc 1 127 9 is_stmt 1 view .LVU108
 498 00a6 FFF7FEFF 		bl	SDCARD_Unselect
 499              	.LVL30:
 128:./FW/sdcard.c ****     }
 500              		.loc 1 128 9 view .LVU109
 128:./FW/sdcard.c ****     }
 501              		.loc 1 128 16 is_stmt 0 view .LVU110
 502 00aa 4FF0FF30 		mov	r0, #-1
 503 00ae EEE7     		b	.L29
 504              	.L56:
 138:./FW/sdcard.c ****         return -2; // not an SDHC/SDXC card (i.e. SDSC, not supported)
 505              		.loc 1 138 9 is_stmt 1 view .LVU111
 506 00b0 FFF7FEFF 		bl	SDCARD_Unselect
 507              	.LVL31:
 139:./FW/sdcard.c ****     }
 508              		.loc 1 139 9 view .LVU112
 139:./FW/sdcard.c ****     }
 509              		.loc 1 139 16 is_stmt 0 view .LVU113
 510 00b4 6FF00100 		mvn	r0, #1
 511 00b8 E9E7     		b	.L29
 512              	.L57:
 513              	.LBB6:
 145:./FW/sdcard.c ****             return -3;
 514              		.loc 1 145 13 is_stmt 1 view .LVU114
 515 00ba FFF7FEFF 		bl	SDCARD_Unselect
 516              	.LVL32:
 146:./FW/sdcard.c ****         }
 517              		.loc 1 146 13 view .LVU115
 146:./FW/sdcard.c ****         }
 518              		.loc 1 146 20 is_stmt 0 view .LVU116
 519 00be 6FF00200 		mvn	r0, #2
 520 00c2 E4E7     		b	.L29
 521              	.L41:
 522              	.LBE6:
 159:./FW/sdcard.c ****         if(SDCARD_WaitNotBusy() < 0) { // keep this!
 523              		.loc 1 159 5 is_stmt 1 view .LVU117
 524              	.LBB7:
 160:./FW/sdcard.c ****             SDCARD_Unselect();
 525              		.loc 1 160 9 view .LVU118
 160:./FW/sdcard.c ****             SDCARD_Unselect();
 526              		.loc 1 160 12 is_stmt 0 view .LVU119
 527 00c4 FFF7FEFF 		bl	SDCARD_WaitNotBusy
 528              	.LVL33:
 160:./FW/sdcard.c ****             SDCARD_Unselect();
 529              		.loc 1 160 11 view .LVU120
 530 00c8 0028     		cmp	r0, #0
 531 00ca 1FDB     		blt	.L58
 532              	.LBB8:
 166:./FW/sdcard.c ****             { 0x40 | 0x37 /* CMD55 */, 0x00, 0x00, 0x00, 0x00 /* ARG */, (0x7F << 1) | 1 /* CRC7 + 
 533              		.loc 1 166 13 is_stmt 1 view .LVU121
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 15


 168:./FW/sdcard.c ****         }
 534              		.loc 1 168 13 view .LVU122
 535 00cc 4FF0FF33 		mov	r3, #-1
 536 00d0 0622     		movs	r2, #6
 537 00d2 3249     		ldr	r1, .L64+12
 538 00d4 2E48     		ldr	r0, .L64
 539 00d6 FFF7FEFF 		bl	HAL_SPI_Transmit
 540              	.LVL34:
 541              	.LBE8:
 171:./FW/sdcard.c ****             SDCARD_Unselect();
 542              		.loc 1 171 9 view .LVU123
 171:./FW/sdcard.c ****             SDCARD_Unselect();
 543              		.loc 1 171 12 is_stmt 0 view .LVU124
 544 00da FFF7FEFF 		bl	SDCARD_ReadR1
 545              	.LVL35:
 171:./FW/sdcard.c ****             SDCARD_Unselect();
 546              		.loc 1 171 11 view .LVU125
 547 00de 0128     		cmp	r0, #1
 548 00e0 19D1     		bne	.L59
 176:./FW/sdcard.c ****             SDCARD_Unselect();
 549              		.loc 1 176 9 is_stmt 1 view .LVU126
 176:./FW/sdcard.c ****             SDCARD_Unselect();
 550              		.loc 1 176 12 is_stmt 0 view .LVU127
 551 00e2 FFF7FEFF 		bl	SDCARD_WaitNotBusy
 552              	.LVL36:
 176:./FW/sdcard.c ****             SDCARD_Unselect();
 553              		.loc 1 176 11 view .LVU128
 554 00e6 0028     		cmp	r0, #0
 555 00e8 1ADB     		blt	.L60
 556              	.LBB9:
 182:./FW/sdcard.c ****             { 0x40 | 0x29 /* ACMD41 */, 0x40, 0x00, 0x00, 0x00 /* ARG */, (0x7F << 1) | 1 /* CRC7 +
 557              		.loc 1 182 13 is_stmt 1 view .LVU129
 184:./FW/sdcard.c ****         }
 558              		.loc 1 184 13 view .LVU130
 559 00ea 4FF0FF33 		mov	r3, #-1
 560 00ee 0622     		movs	r2, #6
 561 00f0 2B49     		ldr	r1, .L64+16
 562 00f2 2748     		ldr	r0, .L64
 563 00f4 FFF7FEFF 		bl	HAL_SPI_Transmit
 564              	.LVL37:
 565              	.LBE9:
 187:./FW/sdcard.c ****         if(r1 == 0x00) {
 566              		.loc 1 187 9 view .LVU131
 187:./FW/sdcard.c ****         if(r1 == 0x00) {
 567              		.loc 1 187 22 is_stmt 0 view .LVU132
 568 00f8 FFF7FEFF 		bl	SDCARD_ReadR1
 569              	.LVL38:
 188:./FW/sdcard.c ****             break;
 570              		.loc 1 188 9 is_stmt 1 view .LVU133
 188:./FW/sdcard.c ****             break;
 571              		.loc 1 188 11 is_stmt 0 view .LVU134
 572 00fc A8B1     		cbz	r0, .L45
 192:./FW/sdcard.c ****             SDCARD_Unselect();
 573              		.loc 1 192 9 is_stmt 1 view .LVU135
 192:./FW/sdcard.c ****             SDCARD_Unselect();
 574              		.loc 1 192 11 is_stmt 0 view .LVU136
 575 00fe 0128     		cmp	r0, #1
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 16


 576 0100 E0D0     		beq	.L41
 193:./FW/sdcard.c ****             return -6;
 577              		.loc 1 193 13 is_stmt 1 view .LVU137
 578 0102 FFF7FEFF 		bl	SDCARD_Unselect
 579              	.LVL39:
 194:./FW/sdcard.c ****         }
 580              		.loc 1 194 13 view .LVU138
 194:./FW/sdcard.c ****         }
 581              		.loc 1 194 20 is_stmt 0 view .LVU139
 582 0106 6FF00500 		mvn	r0, #5
 583 010a C0E7     		b	.L29
 584              	.L58:
 161:./FW/sdcard.c ****             return -1;
 585              		.loc 1 161 13 is_stmt 1 view .LVU140
 586 010c FFF7FEFF 		bl	SDCARD_Unselect
 587              	.LVL40:
 162:./FW/sdcard.c ****         }
 588              		.loc 1 162 13 view .LVU141
 162:./FW/sdcard.c ****         }
 589              		.loc 1 162 20 is_stmt 0 view .LVU142
 590 0110 4FF0FF30 		mov	r0, #-1
 591 0114 BBE7     		b	.L29
 592              	.L59:
 172:./FW/sdcard.c ****             return -5;
 593              		.loc 1 172 13 is_stmt 1 view .LVU143
 594 0116 FFF7FEFF 		bl	SDCARD_Unselect
 595              	.LVL41:
 173:./FW/sdcard.c ****         }
 596              		.loc 1 173 13 view .LVU144
 173:./FW/sdcard.c ****         }
 597              		.loc 1 173 20 is_stmt 0 view .LVU145
 598 011a 6FF00400 		mvn	r0, #4
 599 011e B6E7     		b	.L29
 600              	.L60:
 177:./FW/sdcard.c ****             return -1;
 601              		.loc 1 177 13 is_stmt 1 view .LVU146
 602 0120 FFF7FEFF 		bl	SDCARD_Unselect
 603              	.LVL42:
 178:./FW/sdcard.c ****         }
 604              		.loc 1 178 13 view .LVU147
 178:./FW/sdcard.c ****         }
 605              		.loc 1 178 20 is_stmt 0 view .LVU148
 606 0124 4FF0FF30 		mov	r0, #-1
 607 0128 B1E7     		b	.L29
 608              	.LVL43:
 609              	.L45:
 178:./FW/sdcard.c ****         }
 610              		.loc 1 178 20 view .LVU149
 611              	.LBE7:
 204:./FW/sdcard.c ****         SDCARD_Unselect();
 612              		.loc 1 204 5 is_stmt 1 view .LVU150
 204:./FW/sdcard.c ****         SDCARD_Unselect();
 613              		.loc 1 204 8 is_stmt 0 view .LVU151
 614 012a FFF7FEFF 		bl	SDCARD_WaitNotBusy
 615              	.LVL44:
 204:./FW/sdcard.c ****         SDCARD_Unselect();
 616              		.loc 1 204 7 view .LVU152
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 17


 617 012e 0028     		cmp	r0, #0
 618 0130 1ADB     		blt	.L61
 619              	.LBB10:
 210:./FW/sdcard.c ****         { 0x40 | 0x3A /* CMD58 */, 0x00, 0x00, 0x00, 0x00 /* ARG */, (0x7F << 1) | 1 /* CRC7 + end 
 620              		.loc 1 210 9 is_stmt 1 view .LVU153
 212:./FW/sdcard.c ****     }
 621              		.loc 1 212 9 view .LVU154
 622 0132 4FF0FF33 		mov	r3, #-1
 623 0136 0622     		movs	r2, #6
 624 0138 1A49     		ldr	r1, .L64+20
 625 013a 1548     		ldr	r0, .L64
 626 013c FFF7FEFF 		bl	HAL_SPI_Transmit
 627              	.LVL45:
 628              	.LBE10:
 215:./FW/sdcard.c ****         SDCARD_Unselect();
 629              		.loc 1 215 5 view .LVU155
 215:./FW/sdcard.c ****         SDCARD_Unselect();
 630              		.loc 1 215 8 is_stmt 0 view .LVU156
 631 0140 FFF7FEFF 		bl	SDCARD_ReadR1
 632              	.LVL46:
 215:./FW/sdcard.c ****         SDCARD_Unselect();
 633              		.loc 1 215 7 view .LVU157
 634 0144 A8B9     		cbnz	r0, .L62
 635              	.LBB11:
 221:./FW/sdcard.c ****         if(SDCARD_ReadBytes(resp, sizeof(resp)) < 0) {
 636              		.loc 1 221 9 is_stmt 1 view .LVU158
 222:./FW/sdcard.c ****             SDCARD_Unselect();
 637              		.loc 1 222 9 view .LVU159
 222:./FW/sdcard.c ****             SDCARD_Unselect();
 638              		.loc 1 222 12 is_stmt 0 view .LVU160
 639 0146 0421     		movs	r1, #4
 640 0148 6846     		mov	r0, sp
 641 014a FFF7FEFF 		bl	SDCARD_ReadBytes
 642              	.LVL47:
 222:./FW/sdcard.c ****             SDCARD_Unselect();
 643              		.loc 1 222 11 view .LVU161
 644 014e 0028     		cmp	r0, #0
 645 0150 14DB     		blt	.L63
 227:./FW/sdcard.c ****             SDCARD_Unselect();
 646              		.loc 1 227 9 is_stmt 1 view .LVU162
 227:./FW/sdcard.c ****             SDCARD_Unselect();
 647              		.loc 1 227 17 is_stmt 0 view .LVU163
 648 0152 9DF80030 		ldrb	r3, [sp]	@ zero_extendqisi2
 227:./FW/sdcard.c ****             SDCARD_Unselect();
 649              		.loc 1 227 11 view .LVU164
 650 0156 03F0C003 		and	r3, r3, #192
 651 015a C02B     		cmp	r3, #192
 652 015c 13D0     		beq	.L50
 228:./FW/sdcard.c ****             return -9;
 653              		.loc 1 228 13 is_stmt 1 view .LVU165
 654 015e FFF7FEFF 		bl	SDCARD_Unselect
 655              	.LVL48:
 229:./FW/sdcard.c ****         }
 656              		.loc 1 229 13 view .LVU166
 229:./FW/sdcard.c ****         }
 657              		.loc 1 229 20 is_stmt 0 view .LVU167
 658 0162 6FF00800 		mvn	r0, #8
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 18


 659 0166 92E7     		b	.L29
 660              	.L61:
 661              	.LBE11:
 205:./FW/sdcard.c ****         return -1;
 662              		.loc 1 205 9 is_stmt 1 view .LVU168
 663 0168 FFF7FEFF 		bl	SDCARD_Unselect
 664              	.LVL49:
 206:./FW/sdcard.c ****     }
 665              		.loc 1 206 9 view .LVU169
 206:./FW/sdcard.c ****     }
 666              		.loc 1 206 16 is_stmt 0 view .LVU170
 667 016c 4FF0FF30 		mov	r0, #-1
 668 0170 8DE7     		b	.L29
 669              	.L62:
 216:./FW/sdcard.c ****         return -7;
 670              		.loc 1 216 9 is_stmt 1 view .LVU171
 671 0172 FFF7FEFF 		bl	SDCARD_Unselect
 672              	.LVL50:
 217:./FW/sdcard.c ****     }
 673              		.loc 1 217 9 view .LVU172
 217:./FW/sdcard.c ****     }
 674              		.loc 1 217 16 is_stmt 0 view .LVU173
 675 0176 6FF00600 		mvn	r0, #6
 676 017a 88E7     		b	.L29
 677              	.L63:
 678              	.LBB12:
 223:./FW/sdcard.c ****             return -8;
 679              		.loc 1 223 13 is_stmt 1 view .LVU174
 680 017c FFF7FEFF 		bl	SDCARD_Unselect
 681              	.LVL51:
 224:./FW/sdcard.c ****         }
 682              		.loc 1 224 13 view .LVU175
 224:./FW/sdcard.c ****         }
 683              		.loc 1 224 20 is_stmt 0 view .LVU176
 684 0180 6FF00700 		mvn	r0, #7
 685 0184 83E7     		b	.L29
 686              	.L50:
 687              	.LBE12:
 233:./FW/sdcard.c ****     return 0;
 688              		.loc 1 233 5 is_stmt 1 view .LVU177
 689 0186 FFF7FEFF 		bl	SDCARD_Unselect
 690              	.LVL52:
 234:./FW/sdcard.c **** }
 691              		.loc 1 234 5 view .LVU178
 234:./FW/sdcard.c **** }
 692              		.loc 1 234 12 is_stmt 0 view .LVU179
 693 018a 0020     		movs	r0, #0
 694 018c 7FE7     		b	.L29
 695              	.L65:
 696 018e 00BF     		.align	2
 697              	.L64:
 698 0190 00000000 		.word	hspi1
 699 0194 00000000 		.word	.LANCHOR0
 700 0198 00000000 		.word	.LANCHOR1
 701 019c 00000000 		.word	.LANCHOR2
 702 01a0 00000000 		.word	.LANCHOR3
 703 01a4 00000000 		.word	.LANCHOR4
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 19


 704              		.cfi_endproc
 705              	.LFE138:
 707              		.section	.text.SDCARD_GetBlocksNumber,"ax",%progbits
 708              		.align	1
 709              		.global	SDCARD_GetBlocksNumber
 710              		.syntax unified
 711              		.thumb
 712              		.thumb_func
 713              		.fpu fpv4-sp-d16
 715              	SDCARD_GetBlocksNumber:
 716              	.LVL53:
 717              	.LFB139:
 236:./FW/sdcard.c **** 
 237:./FW/sdcard.c **** 
 238:./FW/sdcard.c **** int SDCARD_GetBlocksNumber(uint32_t* num) {
 718              		.loc 1 238 43 is_stmt 1 view -0
 719              		.cfi_startproc
 720              		@ args = 0, pretend = 0, frame = 24
 721              		@ frame_needed = 0, uses_anonymous_args = 0
 722              		.loc 1 238 43 is_stmt 0 view .LVU181
 723 0000 10B5     		push	{r4, lr}
 724              	.LCFI18:
 725              		.cfi_def_cfa_offset 8
 726              		.cfi_offset 4, -8
 727              		.cfi_offset 14, -4
 728 0002 86B0     		sub	sp, sp, #24
 729              	.LCFI19:
 730              		.cfi_def_cfa_offset 32
 731 0004 0446     		mov	r4, r0
 239:./FW/sdcard.c ****     uint8_t csd[16];
 732              		.loc 1 239 5 is_stmt 1 view .LVU182
 240:./FW/sdcard.c ****     uint8_t crc[2];
 733              		.loc 1 240 5 view .LVU183
 241:./FW/sdcard.c **** 
 242:./FW/sdcard.c ****     SDCARD_Select();
 734              		.loc 1 242 5 view .LVU184
 735 0006 FFF7FEFF 		bl	SDCARD_Select
 736              	.LVL54:
 243:./FW/sdcard.c **** 
 244:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) { // keep this!
 737              		.loc 1 244 5 view .LVU185
 738              		.loc 1 244 8 is_stmt 0 view .LVU186
 739 000a FFF7FEFF 		bl	SDCARD_WaitNotBusy
 740              	.LVL55:
 741              		.loc 1 244 7 view .LVU187
 742 000e 0028     		cmp	r0, #0
 743 0010 34DB     		blt	.L75
 744              	.LBB13:
 245:./FW/sdcard.c ****         SDCARD_Unselect();
 246:./FW/sdcard.c ****         return -1;
 247:./FW/sdcard.c ****     }
 248:./FW/sdcard.c **** 
 249:./FW/sdcard.c ****     /* CMD9 (SEND_CSD) command */
 250:./FW/sdcard.c ****     {
 251:./FW/sdcard.c ****         static const uint8_t cmd[] =
 745              		.loc 1 251 9 is_stmt 1 view .LVU188
 252:./FW/sdcard.c ****         { 0x40 | 0x09 /* CMD9 */, 0x00, 0x00, 0x00, 0x00 /* ARG */, (0x7F << 1) | 1 /* CRC7 + end b
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 20


 253:./FW/sdcard.c ****         HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 746              		.loc 1 253 9 view .LVU189
 747 0012 4FF0FF33 		mov	r3, #-1
 748 0016 0622     		movs	r2, #6
 749 0018 2649     		ldr	r1, .L80
 750 001a 2748     		ldr	r0, .L80+4
 751 001c FFF7FEFF 		bl	HAL_SPI_Transmit
 752              	.LVL56:
 753              	.LBE13:
 254:./FW/sdcard.c ****     }
 255:./FW/sdcard.c **** 
 256:./FW/sdcard.c ****     if(SDCARD_ReadR1() != 0x00) {
 754              		.loc 1 256 5 view .LVU190
 755              		.loc 1 256 8 is_stmt 0 view .LVU191
 756 0020 FFF7FEFF 		bl	SDCARD_ReadR1
 757              	.LVL57:
 758              		.loc 1 256 7 view .LVU192
 759 0024 78BB     		cbnz	r0, .L76
 257:./FW/sdcard.c ****         SDCARD_Unselect();
 258:./FW/sdcard.c ****         return -2;
 259:./FW/sdcard.c ****     }
 260:./FW/sdcard.c **** 
 261:./FW/sdcard.c ****     if(SDCARD_WaitDataToken(DATA_TOKEN_CMD9) < 0) {
 760              		.loc 1 261 5 is_stmt 1 view .LVU193
 761              		.loc 1 261 8 is_stmt 0 view .LVU194
 762 0026 FE20     		movs	r0, #254
 763 0028 FFF7FEFF 		bl	SDCARD_WaitDataToken
 764              	.LVL58:
 765              		.loc 1 261 7 view .LVU195
 766 002c 0028     		cmp	r0, #0
 767 002e 2FDB     		blt	.L77
 262:./FW/sdcard.c ****         SDCARD_Unselect();
 263:./FW/sdcard.c ****         return -3;
 264:./FW/sdcard.c ****     }
 265:./FW/sdcard.c **** 
 266:./FW/sdcard.c ****     if(SDCARD_ReadBytes(csd, sizeof(csd)) < 0) {
 768              		.loc 1 266 5 is_stmt 1 view .LVU196
 769              		.loc 1 266 8 is_stmt 0 view .LVU197
 770 0030 1021     		movs	r1, #16
 771 0032 02A8     		add	r0, sp, #8
 772 0034 FFF7FEFF 		bl	SDCARD_ReadBytes
 773              	.LVL59:
 774              		.loc 1 266 7 view .LVU198
 775 0038 0028     		cmp	r0, #0
 776 003a 2EDB     		blt	.L78
 267:./FW/sdcard.c ****         SDCARD_Unselect();
 268:./FW/sdcard.c ****         return -4;
 269:./FW/sdcard.c ****     }
 270:./FW/sdcard.c **** 
 271:./FW/sdcard.c ****     if(SDCARD_ReadBytes(crc, sizeof(crc)) < 0) {
 777              		.loc 1 271 5 is_stmt 1 view .LVU199
 778              		.loc 1 271 8 is_stmt 0 view .LVU200
 779 003c 0221     		movs	r1, #2
 780 003e 01A8     		add	r0, sp, #4
 781 0040 FFF7FEFF 		bl	SDCARD_ReadBytes
 782              	.LVL60:
 783              		.loc 1 271 7 view .LVU201
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 21


 784 0044 0028     		cmp	r0, #0
 785 0046 2DDB     		blt	.L79
 272:./FW/sdcard.c ****         SDCARD_Unselect();
 273:./FW/sdcard.c ****         return -5;
 274:./FW/sdcard.c ****     }
 275:./FW/sdcard.c **** 
 276:./FW/sdcard.c ****     SDCARD_Unselect();
 786              		.loc 1 276 5 is_stmt 1 view .LVU202
 787 0048 FFF7FEFF 		bl	SDCARD_Unselect
 788              	.LVL61:
 277:./FW/sdcard.c **** 
 278:./FW/sdcard.c ****     // first byte is VVxxxxxxxx where VV is csd.version
 279:./FW/sdcard.c ****     if((csd[0] & 0xC0) != 0x40) // csd.version != 1
 789              		.loc 1 279 5 view .LVU203
 790              		.loc 1 279 12 is_stmt 0 view .LVU204
 791 004c 9DF80830 		ldrb	r3, [sp, #8]	@ zero_extendqisi2
 792              		.loc 1 279 7 view .LVU205
 793 0050 03F0C003 		and	r3, r3, #192
 794 0054 402B     		cmp	r3, #64
 795 0056 2AD1     		bne	.L73
 280:./FW/sdcard.c ****     { return -6; }
 281:./FW/sdcard.c **** 
 282:./FW/sdcard.c ****     uint32_t tmp = csd[7] & 0x3F; // two bits are reserved
 796              		.loc 1 282 5 is_stmt 1 view .LVU206
 797              		.loc 1 282 23 is_stmt 0 view .LVU207
 798 0058 9DF80F20 		ldrb	r2, [sp, #15]	@ zero_extendqisi2
 799              		.loc 1 282 14 view .LVU208
 800 005c 02F03F02 		and	r2, r2, #63
 801              	.LVL62:
 283:./FW/sdcard.c ****     tmp = (tmp << 8) | csd[8];
 802              		.loc 1 283 5 is_stmt 1 view .LVU209
 803              		.loc 1 283 27 is_stmt 0 view .LVU210
 804 0060 9DF81030 		ldrb	r3, [sp, #16]	@ zero_extendqisi2
 805              		.loc 1 283 9 view .LVU211
 806 0064 43EA0222 		orr	r2, r3, r2, lsl #8
 807              	.LVL63:
 284:./FW/sdcard.c ****     tmp = (tmp << 8) | csd[9];
 808              		.loc 1 284 5 is_stmt 1 view .LVU212
 809              		.loc 1 284 27 is_stmt 0 view .LVU213
 810 0068 9DF81130 		ldrb	r3, [sp, #17]	@ zero_extendqisi2
 811              		.loc 1 284 9 view .LVU214
 812 006c 43EA0223 		orr	r3, r3, r2, lsl #8
 813              	.LVL64:
 285:./FW/sdcard.c ****     // Full volume: (C_SIZE+1)*512KByte == (C_SIZE+1)<<19
 286:./FW/sdcard.c ****     // Block size: 512Byte == 1<<9
 287:./FW/sdcard.c ****     // Blocks number: CARD_SIZE/BLOCK_SIZE = (C_SIZE+1)*(1<<19) / (1<<9) = (C_SIZE+1)*(1<<10)
 288:./FW/sdcard.c ****     tmp = (tmp + 1) << 10;
 814              		.loc 1 288 5 is_stmt 1 view .LVU215
 815              		.loc 1 288 16 is_stmt 0 view .LVU216
 816 0070 0133     		adds	r3, r3, #1
 817              	.LVL65:
 818              		.loc 1 288 9 view .LVU217
 819 0072 9B02     		lsls	r3, r3, #10
 820              	.LVL66:
 289:./FW/sdcard.c ****     *num = tmp;
 821              		.loc 1 289 5 is_stmt 1 view .LVU218
 822              		.loc 1 289 10 is_stmt 0 view .LVU219
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 22


 823 0074 2360     		str	r3, [r4]
 290:./FW/sdcard.c **** 
 291:./FW/sdcard.c ****     return 0;
 824              		.loc 1 291 5 is_stmt 1 view .LVU220
 825              		.loc 1 291 12 is_stmt 0 view .LVU221
 826 0076 0020     		movs	r0, #0
 827              	.LVL67:
 828              	.L66:
 292:./FW/sdcard.c **** }
 829              		.loc 1 292 1 view .LVU222
 830 0078 06B0     		add	sp, sp, #24
 831              	.LCFI20:
 832              		.cfi_remember_state
 833              		.cfi_def_cfa_offset 8
 834              		@ sp needed
 835 007a 10BD     		pop	{r4, pc}
 836              	.LVL68:
 837              	.L75:
 838              	.LCFI21:
 839              		.cfi_restore_state
 245:./FW/sdcard.c ****         return -1;
 840              		.loc 1 245 9 is_stmt 1 view .LVU223
 841 007c FFF7FEFF 		bl	SDCARD_Unselect
 842              	.LVL69:
 246:./FW/sdcard.c ****     }
 843              		.loc 1 246 9 view .LVU224
 246:./FW/sdcard.c ****     }
 844              		.loc 1 246 16 is_stmt 0 view .LVU225
 845 0080 4FF0FF30 		mov	r0, #-1
 846 0084 F8E7     		b	.L66
 847              	.L76:
 257:./FW/sdcard.c ****         return -2;
 848              		.loc 1 257 9 is_stmt 1 view .LVU226
 849 0086 FFF7FEFF 		bl	SDCARD_Unselect
 850              	.LVL70:
 258:./FW/sdcard.c ****     }
 851              		.loc 1 258 9 view .LVU227
 258:./FW/sdcard.c ****     }
 852              		.loc 1 258 16 is_stmt 0 view .LVU228
 853 008a 6FF00100 		mvn	r0, #1
 854 008e F3E7     		b	.L66
 855              	.L77:
 262:./FW/sdcard.c ****         return -3;
 856              		.loc 1 262 9 is_stmt 1 view .LVU229
 857 0090 FFF7FEFF 		bl	SDCARD_Unselect
 858              	.LVL71:
 263:./FW/sdcard.c ****     }
 859              		.loc 1 263 9 view .LVU230
 263:./FW/sdcard.c ****     }
 860              		.loc 1 263 16 is_stmt 0 view .LVU231
 861 0094 6FF00200 		mvn	r0, #2
 862 0098 EEE7     		b	.L66
 863              	.L78:
 267:./FW/sdcard.c ****         return -4;
 864              		.loc 1 267 9 is_stmt 1 view .LVU232
 865 009a FFF7FEFF 		bl	SDCARD_Unselect
 866              	.LVL72:
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 23


 268:./FW/sdcard.c ****     }
 867              		.loc 1 268 9 view .LVU233
 268:./FW/sdcard.c ****     }
 868              		.loc 1 268 16 is_stmt 0 view .LVU234
 869 009e 6FF00300 		mvn	r0, #3
 870 00a2 E9E7     		b	.L66
 871              	.L79:
 272:./FW/sdcard.c ****         return -5;
 872              		.loc 1 272 9 is_stmt 1 view .LVU235
 873 00a4 FFF7FEFF 		bl	SDCARD_Unselect
 874              	.LVL73:
 273:./FW/sdcard.c ****     }
 875              		.loc 1 273 9 view .LVU236
 273:./FW/sdcard.c ****     }
 876              		.loc 1 273 16 is_stmt 0 view .LVU237
 877 00a8 6FF00400 		mvn	r0, #4
 878 00ac E4E7     		b	.L66
 879              	.L73:
 280:./FW/sdcard.c **** 
 880              		.loc 1 280 14 view .LVU238
 881 00ae 6FF00500 		mvn	r0, #5
 882 00b2 E1E7     		b	.L66
 883              	.L81:
 884              		.align	2
 885              	.L80:
 886 00b4 00000000 		.word	.LANCHOR5
 887 00b8 00000000 		.word	hspi1
 888              		.cfi_endproc
 889              	.LFE139:
 891              		.section	.text.SDCARD_ReadSingleBlock,"ax",%progbits
 892              		.align	1
 893              		.global	SDCARD_ReadSingleBlock
 894              		.syntax unified
 895              		.thumb
 896              		.thumb_func
 897              		.fpu fpv4-sp-d16
 899              	SDCARD_ReadSingleBlock:
 900              	.LVL74:
 901              	.LFB140:
 293:./FW/sdcard.c **** 
 294:./FW/sdcard.c **** int SDCARD_ReadSingleBlock(uint32_t blockNum, uint8_t* buff) {
 902              		.loc 1 294 62 is_stmt 1 view -0
 903              		.cfi_startproc
 904              		@ args = 0, pretend = 0, frame = 16
 905              		@ frame_needed = 0, uses_anonymous_args = 0
 906              		.loc 1 294 62 is_stmt 0 view .LVU240
 907 0000 30B5     		push	{r4, r5, lr}
 908              	.LCFI22:
 909              		.cfi_def_cfa_offset 12
 910              		.cfi_offset 4, -12
 911              		.cfi_offset 5, -8
 912              		.cfi_offset 14, -4
 913 0002 85B0     		sub	sp, sp, #20
 914              	.LCFI23:
 915              		.cfi_def_cfa_offset 32
 916 0004 0446     		mov	r4, r0
 917 0006 0D46     		mov	r5, r1
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 24


 295:./FW/sdcard.c ****     uint8_t crc[2];
 918              		.loc 1 295 5 is_stmt 1 view .LVU241
 296:./FW/sdcard.c **** 
 297:./FW/sdcard.c ****     SDCARD_Select();
 919              		.loc 1 297 5 view .LVU242
 920 0008 FFF7FEFF 		bl	SDCARD_Select
 921              	.LVL75:
 298:./FW/sdcard.c **** 
 299:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) { // keep this!
 922              		.loc 1 299 5 view .LVU243
 923              		.loc 1 299 8 is_stmt 0 view .LVU244
 924 000c FFF7FEFF 		bl	SDCARD_WaitNotBusy
 925              	.LVL76:
 926              		.loc 1 299 7 view .LVU245
 927 0010 0028     		cmp	r0, #0
 928 0012 31DB     		blt	.L90
 300:./FW/sdcard.c ****         SDCARD_Unselect();
 301:./FW/sdcard.c ****         return -1;
 302:./FW/sdcard.c ****     }
 303:./FW/sdcard.c **** 
 304:./FW/sdcard.c ****     /* CMD17 (SEND_SINGLE_BLOCK) command */
 305:./FW/sdcard.c ****     uint8_t cmd[] = {
 929              		.loc 1 305 5 is_stmt 1 view .LVU246
 930              		.loc 1 305 13 is_stmt 0 view .LVU247
 931 0014 5123     		movs	r3, #81
 932 0016 8DF80430 		strb	r3, [sp, #4]
 306:./FW/sdcard.c ****         0x40 | 0x11 /* CMD17 */,
 307:./FW/sdcard.c ****         (blockNum >> 24) & 0xFF, /* ARG */
 933              		.loc 1 307 19 view .LVU248
 934 001a 230E     		lsrs	r3, r4, #24
 305:./FW/sdcard.c ****         0x40 | 0x11 /* CMD17 */,
 935              		.loc 1 305 13 view .LVU249
 936 001c 8DF80530 		strb	r3, [sp, #5]
 308:./FW/sdcard.c ****         (blockNum >> 16) & 0xFF,
 937              		.loc 1 308 19 view .LVU250
 938 0020 230C     		lsrs	r3, r4, #16
 305:./FW/sdcard.c ****         0x40 | 0x11 /* CMD17 */,
 939              		.loc 1 305 13 view .LVU251
 940 0022 8DF80630 		strb	r3, [sp, #6]
 309:./FW/sdcard.c ****         (blockNum >> 8) & 0xFF,
 941              		.loc 1 309 19 view .LVU252
 942 0026 230A     		lsrs	r3, r4, #8
 305:./FW/sdcard.c ****         0x40 | 0x11 /* CMD17 */,
 943              		.loc 1 305 13 view .LVU253
 944 0028 8DF80730 		strb	r3, [sp, #7]
 945 002c 8DF80840 		strb	r4, [sp, #8]
 946 0030 FF23     		movs	r3, #255
 947 0032 8DF80930 		strb	r3, [sp, #9]
 310:./FW/sdcard.c ****         blockNum & 0xFF,
 311:./FW/sdcard.c ****         (0x7F << 1) | 1 /* CRC7 + end bit */
 312:./FW/sdcard.c ****     };
 313:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 948              		.loc 1 313 5 is_stmt 1 view .LVU254
 949 0036 4FF0FF33 		mov	r3, #-1
 950 003a 0622     		movs	r2, #6
 951 003c 01A9     		add	r1, sp, #4
 952 003e 1B48     		ldr	r0, .L95
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 25


 953 0040 FFF7FEFF 		bl	HAL_SPI_Transmit
 954              	.LVL77:
 314:./FW/sdcard.c **** 
 315:./FW/sdcard.c ****     if(SDCARD_ReadR1() != 0x00) {
 955              		.loc 1 315 5 view .LVU255
 956              		.loc 1 315 8 is_stmt 0 view .LVU256
 957 0044 FFF7FEFF 		bl	SDCARD_ReadR1
 958              	.LVL78:
 959              		.loc 1 315 7 view .LVU257
 960 0048 D8B9     		cbnz	r0, .L91
 316:./FW/sdcard.c ****         SDCARD_Unselect();
 317:./FW/sdcard.c ****         return -2;
 318:./FW/sdcard.c ****     }
 319:./FW/sdcard.c **** 
 320:./FW/sdcard.c ****     if(SDCARD_WaitDataToken(DATA_TOKEN_CMD17) < 0) {
 961              		.loc 1 320 5 is_stmt 1 view .LVU258
 962              		.loc 1 320 8 is_stmt 0 view .LVU259
 963 004a FE20     		movs	r0, #254
 964 004c FFF7FEFF 		bl	SDCARD_WaitDataToken
 965              	.LVL79:
 966              		.loc 1 320 7 view .LVU260
 967 0050 0028     		cmp	r0, #0
 968 0052 1BDB     		blt	.L92
 321:./FW/sdcard.c ****         SDCARD_Unselect();
 322:./FW/sdcard.c ****         return -3;
 323:./FW/sdcard.c ****     }
 324:./FW/sdcard.c **** 
 325:./FW/sdcard.c ****     if(SDCARD_ReadBytes(buff, 512) < 0) {
 969              		.loc 1 325 5 is_stmt 1 view .LVU261
 970              		.loc 1 325 8 is_stmt 0 view .LVU262
 971 0054 4FF40071 		mov	r1, #512
 972 0058 2846     		mov	r0, r5
 973 005a FFF7FEFF 		bl	SDCARD_ReadBytes
 974              	.LVL80:
 975              		.loc 1 325 7 view .LVU263
 976 005e 0028     		cmp	r0, #0
 977 0060 19DB     		blt	.L93
 326:./FW/sdcard.c ****         SDCARD_Unselect();
 327:./FW/sdcard.c ****         return -4;
 328:./FW/sdcard.c ****     }
 329:./FW/sdcard.c **** 
 330:./FW/sdcard.c ****     if(SDCARD_ReadBytes(crc, 2) < 0) {
 978              		.loc 1 330 5 is_stmt 1 view .LVU264
 979              		.loc 1 330 8 is_stmt 0 view .LVU265
 980 0062 0221     		movs	r1, #2
 981 0064 03A8     		add	r0, sp, #12
 982 0066 FFF7FEFF 		bl	SDCARD_ReadBytes
 983              	.LVL81:
 984              		.loc 1 330 7 view .LVU266
 985 006a 0028     		cmp	r0, #0
 986 006c 18DB     		blt	.L94
 331:./FW/sdcard.c ****         SDCARD_Unselect();
 332:./FW/sdcard.c ****         return -5;
 333:./FW/sdcard.c ****     }
 334:./FW/sdcard.c **** 
 335:./FW/sdcard.c ****     SDCARD_Unselect();
 987              		.loc 1 335 5 is_stmt 1 view .LVU267
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 26


 988 006e FFF7FEFF 		bl	SDCARD_Unselect
 989              	.LVL82:
 336:./FW/sdcard.c ****     return 0;
 990              		.loc 1 336 5 view .LVU268
 991              		.loc 1 336 12 is_stmt 0 view .LVU269
 992 0072 0020     		movs	r0, #0
 993              	.L82:
 337:./FW/sdcard.c **** }
 994              		.loc 1 337 1 view .LVU270
 995 0074 05B0     		add	sp, sp, #20
 996              	.LCFI24:
 997              		.cfi_remember_state
 998              		.cfi_def_cfa_offset 12
 999              		@ sp needed
 1000 0076 30BD     		pop	{r4, r5, pc}
 1001              	.LVL83:
 1002              	.L90:
 1003              	.LCFI25:
 1004              		.cfi_restore_state
 300:./FW/sdcard.c ****         return -1;
 1005              		.loc 1 300 9 is_stmt 1 view .LVU271
 1006 0078 FFF7FEFF 		bl	SDCARD_Unselect
 1007              	.LVL84:
 301:./FW/sdcard.c ****     }
 1008              		.loc 1 301 9 view .LVU272
 301:./FW/sdcard.c ****     }
 1009              		.loc 1 301 16 is_stmt 0 view .LVU273
 1010 007c 4FF0FF30 		mov	r0, #-1
 1011 0080 F8E7     		b	.L82
 1012              	.L91:
 316:./FW/sdcard.c ****         return -2;
 1013              		.loc 1 316 9 is_stmt 1 view .LVU274
 1014 0082 FFF7FEFF 		bl	SDCARD_Unselect
 1015              	.LVL85:
 317:./FW/sdcard.c ****     }
 1016              		.loc 1 317 9 view .LVU275
 317:./FW/sdcard.c ****     }
 1017              		.loc 1 317 16 is_stmt 0 view .LVU276
 1018 0086 6FF00100 		mvn	r0, #1
 1019 008a F3E7     		b	.L82
 1020              	.L92:
 321:./FW/sdcard.c ****         return -3;
 1021              		.loc 1 321 9 is_stmt 1 view .LVU277
 1022 008c FFF7FEFF 		bl	SDCARD_Unselect
 1023              	.LVL86:
 322:./FW/sdcard.c ****     }
 1024              		.loc 1 322 9 view .LVU278
 322:./FW/sdcard.c ****     }
 1025              		.loc 1 322 16 is_stmt 0 view .LVU279
 1026 0090 6FF00200 		mvn	r0, #2
 1027 0094 EEE7     		b	.L82
 1028              	.L93:
 326:./FW/sdcard.c ****         return -4;
 1029              		.loc 1 326 9 is_stmt 1 view .LVU280
 1030 0096 FFF7FEFF 		bl	SDCARD_Unselect
 1031              	.LVL87:
 327:./FW/sdcard.c ****     }
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 27


 1032              		.loc 1 327 9 view .LVU281
 327:./FW/sdcard.c ****     }
 1033              		.loc 1 327 16 is_stmt 0 view .LVU282
 1034 009a 6FF00300 		mvn	r0, #3
 1035 009e E9E7     		b	.L82
 1036              	.L94:
 331:./FW/sdcard.c ****         return -5;
 1037              		.loc 1 331 9 is_stmt 1 view .LVU283
 1038 00a0 FFF7FEFF 		bl	SDCARD_Unselect
 1039              	.LVL88:
 332:./FW/sdcard.c ****     }
 1040              		.loc 1 332 9 view .LVU284
 332:./FW/sdcard.c ****     }
 1041              		.loc 1 332 16 is_stmt 0 view .LVU285
 1042 00a4 6FF00400 		mvn	r0, #4
 1043 00a8 E4E7     		b	.L82
 1044              	.L96:
 1045 00aa 00BF     		.align	2
 1046              	.L95:
 1047 00ac 00000000 		.word	hspi1
 1048              		.cfi_endproc
 1049              	.LFE140:
 1051              		.section	.text.SDCARD_WriteSingleBlock,"ax",%progbits
 1052              		.align	1
 1053              		.global	SDCARD_WriteSingleBlock
 1054              		.syntax unified
 1055              		.thumb
 1056              		.thumb_func
 1057              		.fpu fpv4-sp-d16
 1059              	SDCARD_WriteSingleBlock:
 1060              	.LVL89:
 1061              	.LFB141:
 338:./FW/sdcard.c **** 
 339:./FW/sdcard.c **** 
 340:./FW/sdcard.c **** int SDCARD_WriteSingleBlock(uint32_t blockNum, const uint8_t* buff) {
 1062              		.loc 1 340 69 is_stmt 1 view -0
 1063              		.cfi_startproc
 1064              		@ args = 0, pretend = 0, frame = 16
 1065              		@ frame_needed = 0, uses_anonymous_args = 0
 1066              		.loc 1 340 69 is_stmt 0 view .LVU287
 1067 0000 30B5     		push	{r4, r5, lr}
 1068              	.LCFI26:
 1069              		.cfi_def_cfa_offset 12
 1070              		.cfi_offset 4, -12
 1071              		.cfi_offset 5, -8
 1072              		.cfi_offset 14, -4
 1073 0002 85B0     		sub	sp, sp, #20
 1074              	.LCFI27:
 1075              		.cfi_def_cfa_offset 32
 1076 0004 0446     		mov	r4, r0
 1077 0006 0D46     		mov	r5, r1
 341:./FW/sdcard.c ****     SDCARD_Select();
 1078              		.loc 1 341 5 is_stmt 1 view .LVU288
 1079 0008 FFF7FEFF 		bl	SDCARD_Select
 1080              	.LVL90:
 342:./FW/sdcard.c **** 
 343:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) { // keep this!
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 28


 1081              		.loc 1 343 5 view .LVU289
 1082              		.loc 1 343 8 is_stmt 0 view .LVU290
 1083 000c FFF7FEFF 		bl	SDCARD_WaitNotBusy
 1084              	.LVL91:
 1085              		.loc 1 343 7 view .LVU291
 1086 0010 0028     		cmp	r0, #0
 1087 0012 4DDB     		blt	.L104
 344:./FW/sdcard.c ****         SDCARD_Unselect();
 345:./FW/sdcard.c ****         return -1;
 346:./FW/sdcard.c ****     }
 347:./FW/sdcard.c **** 
 348:./FW/sdcard.c ****     /* CMD24 (WRITE_BLOCK) command */
 349:./FW/sdcard.c ****     uint8_t cmd[] = {
 1088              		.loc 1 349 5 is_stmt 1 view .LVU292
 1089              		.loc 1 349 13 is_stmt 0 view .LVU293
 1090 0014 5823     		movs	r3, #88
 1091 0016 8DF80830 		strb	r3, [sp, #8]
 350:./FW/sdcard.c ****         0x40 | 0x18 /* CMD24 */,
 351:./FW/sdcard.c ****         (blockNum >> 24) & 0xFF, /* ARG */
 1092              		.loc 1 351 19 view .LVU294
 1093 001a 230E     		lsrs	r3, r4, #24
 349:./FW/sdcard.c ****         0x40 | 0x18 /* CMD24 */,
 1094              		.loc 1 349 13 view .LVU295
 1095 001c 8DF80930 		strb	r3, [sp, #9]
 352:./FW/sdcard.c ****         (blockNum >> 16) & 0xFF,
 1096              		.loc 1 352 19 view .LVU296
 1097 0020 230C     		lsrs	r3, r4, #16
 349:./FW/sdcard.c ****         0x40 | 0x18 /* CMD24 */,
 1098              		.loc 1 349 13 view .LVU297
 1099 0022 8DF80A30 		strb	r3, [sp, #10]
 353:./FW/sdcard.c ****         (blockNum >> 8) & 0xFF,
 1100              		.loc 1 353 19 view .LVU298
 1101 0026 230A     		lsrs	r3, r4, #8
 349:./FW/sdcard.c ****         0x40 | 0x18 /* CMD24 */,
 1102              		.loc 1 349 13 view .LVU299
 1103 0028 8DF80B30 		strb	r3, [sp, #11]
 1104 002c 8DF80C40 		strb	r4, [sp, #12]
 1105 0030 FF23     		movs	r3, #255
 1106 0032 8DF80D30 		strb	r3, [sp, #13]
 354:./FW/sdcard.c ****         blockNum & 0xFF,
 355:./FW/sdcard.c ****         (0x7F << 1) | 1 /* CRC7 + end bit */
 356:./FW/sdcard.c ****     };
 357:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 1107              		.loc 1 357 5 is_stmt 1 view .LVU300
 1108 0036 4FF0FF33 		mov	r3, #-1
 1109 003a 0622     		movs	r2, #6
 1110 003c 02A9     		add	r1, sp, #8
 1111 003e 2648     		ldr	r0, .L108
 1112 0040 FFF7FEFF 		bl	HAL_SPI_Transmit
 1113              	.LVL92:
 358:./FW/sdcard.c **** 
 359:./FW/sdcard.c ****     if(SDCARD_ReadR1() != 0x00) {
 1114              		.loc 1 359 5 view .LVU301
 1115              		.loc 1 359 8 is_stmt 0 view .LVU302
 1116 0044 FFF7FEFF 		bl	SDCARD_ReadR1
 1117              	.LVL93:
 1118              		.loc 1 359 7 view .LVU303
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 29


 1119 0048 B8BB     		cbnz	r0, .L105
 360:./FW/sdcard.c ****         SDCARD_Unselect();
 361:./FW/sdcard.c ****         return -2;
 362:./FW/sdcard.c ****     }
 363:./FW/sdcard.c **** 
 364:./FW/sdcard.c ****     uint8_t dataToken = DATA_TOKEN_CMD24;
 1120              		.loc 1 364 5 is_stmt 1 view .LVU304
 1121              		.loc 1 364 13 is_stmt 0 view .LVU305
 1122 004a FE23     		movs	r3, #254
 1123 004c 8DF80730 		strb	r3, [sp, #7]
 365:./FW/sdcard.c ****     uint8_t crc[2] = { 0xFF, 0xFF };
 1124              		.loc 1 365 5 is_stmt 1 view .LVU306
 1125              		.loc 1 365 13 is_stmt 0 view .LVU307
 1126 0050 4FF6FF73 		movw	r3, #65535
 1127 0054 ADF80430 		strh	r3, [sp, #4]	@ movhi
 366:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, &dataToken, sizeof(dataToken), HAL_MAX_DELAY);
 1128              		.loc 1 366 5 is_stmt 1 view .LVU308
 1129 0058 1F4C     		ldr	r4, .L108
 1130              	.LVL94:
 1131              		.loc 1 366 5 is_stmt 0 view .LVU309
 1132 005a 4FF0FF33 		mov	r3, #-1
 1133 005e 0122     		movs	r2, #1
 1134 0060 0DF10701 		add	r1, sp, #7
 1135 0064 2046     		mov	r0, r4
 1136 0066 FFF7FEFF 		bl	HAL_SPI_Transmit
 1137              	.LVL95:
 367:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)buff, 512, HAL_MAX_DELAY);
 1138              		.loc 1 367 5 is_stmt 1 view .LVU310
 1139 006a 4FF0FF33 		mov	r3, #-1
 1140 006e 4FF40072 		mov	r2, #512
 1141 0072 2946     		mov	r1, r5
 1142 0074 2046     		mov	r0, r4
 1143 0076 FFF7FEFF 		bl	HAL_SPI_Transmit
 1144              	.LVL96:
 368:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, crc, sizeof(crc), HAL_MAX_DELAY);
 1145              		.loc 1 368 5 view .LVU311
 1146 007a 4FF0FF33 		mov	r3, #-1
 1147 007e 0222     		movs	r2, #2
 1148 0080 01A9     		add	r1, sp, #4
 1149 0082 2046     		mov	r0, r4
 1150 0084 FFF7FEFF 		bl	HAL_SPI_Transmit
 1151              	.LVL97:
 369:./FW/sdcard.c **** 
 370:./FW/sdcard.c ****     /*
 371:./FW/sdcard.c ****         dataResp:
 372:./FW/sdcard.c ****         xxx0abc1
 373:./FW/sdcard.c ****             010 - Data accepted
 374:./FW/sdcard.c ****             101 - Data rejected due to CRC error
 375:./FW/sdcard.c ****             110 - Data rejected due to write error
 376:./FW/sdcard.c ****     */
 377:./FW/sdcard.c ****     uint8_t dataResp;
 1152              		.loc 1 377 5 view .LVU312
 378:./FW/sdcard.c ****     SDCARD_ReadBytes(&dataResp, sizeof(dataResp));
 1153              		.loc 1 378 5 view .LVU313
 1154 0088 0121     		movs	r1, #1
 1155 008a 0DF10300 		add	r0, sp, #3
 1156 008e FFF7FEFF 		bl	SDCARD_ReadBytes
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 30


 1157              	.LVL98:
 379:./FW/sdcard.c ****     if((dataResp & 0x1F) != 0x05) { // data rejected
 1158              		.loc 1 379 5 view .LVU314
 1159              		.loc 1 379 18 is_stmt 0 view .LVU315
 1160 0092 9DF80330 		ldrb	r3, [sp, #3]	@ zero_extendqisi2
 1161              		.loc 1 379 7 view .LVU316
 1162 0096 03F01F03 		and	r3, r3, #31
 1163 009a 052B     		cmp	r3, #5
 1164 009c 12D1     		bne	.L106
 380:./FW/sdcard.c ****         SDCARD_Unselect();
 381:./FW/sdcard.c ****         return -3;
 382:./FW/sdcard.c ****     }
 383:./FW/sdcard.c **** 
 384:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) {
 1165              		.loc 1 384 5 is_stmt 1 view .LVU317
 1166              		.loc 1 384 8 is_stmt 0 view .LVU318
 1167 009e FFF7FEFF 		bl	SDCARD_WaitNotBusy
 1168              	.LVL99:
 1169              		.loc 1 384 7 view .LVU319
 1170 00a2 0028     		cmp	r0, #0
 1171 00a4 13DB     		blt	.L107
 385:./FW/sdcard.c ****         SDCARD_Unselect();
 386:./FW/sdcard.c ****         return -4;
 387:./FW/sdcard.c ****     }
 388:./FW/sdcard.c **** 
 389:./FW/sdcard.c ****     SDCARD_Unselect();
 1172              		.loc 1 389 5 is_stmt 1 view .LVU320
 1173 00a6 FFF7FEFF 		bl	SDCARD_Unselect
 1174              	.LVL100:
 390:./FW/sdcard.c ****     return 0;
 1175              		.loc 1 390 5 view .LVU321
 1176              		.loc 1 390 12 is_stmt 0 view .LVU322
 1177 00aa 0020     		movs	r0, #0
 1178              	.L97:
 391:./FW/sdcard.c **** }
 1179              		.loc 1 391 1 view .LVU323
 1180 00ac 05B0     		add	sp, sp, #20
 1181              	.LCFI28:
 1182              		.cfi_remember_state
 1183              		.cfi_def_cfa_offset 12
 1184              		@ sp needed
 1185 00ae 30BD     		pop	{r4, r5, pc}
 1186              	.LVL101:
 1187              	.L104:
 1188              	.LCFI29:
 1189              		.cfi_restore_state
 344:./FW/sdcard.c ****         return -1;
 1190              		.loc 1 344 9 is_stmt 1 view .LVU324
 1191 00b0 FFF7FEFF 		bl	SDCARD_Unselect
 1192              	.LVL102:
 345:./FW/sdcard.c ****     }
 1193              		.loc 1 345 9 view .LVU325
 345:./FW/sdcard.c ****     }
 1194              		.loc 1 345 16 is_stmt 0 view .LVU326
 1195 00b4 4FF0FF30 		mov	r0, #-1
 1196 00b8 F8E7     		b	.L97
 1197              	.L105:
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 31


 360:./FW/sdcard.c ****         return -2;
 1198              		.loc 1 360 9 is_stmt 1 view .LVU327
 1199 00ba FFF7FEFF 		bl	SDCARD_Unselect
 1200              	.LVL103:
 361:./FW/sdcard.c ****     }
 1201              		.loc 1 361 9 view .LVU328
 361:./FW/sdcard.c ****     }
 1202              		.loc 1 361 16 is_stmt 0 view .LVU329
 1203 00be 6FF00100 		mvn	r0, #1
 1204 00c2 F3E7     		b	.L97
 1205              	.LVL104:
 1206              	.L106:
 380:./FW/sdcard.c ****         return -3;
 1207              		.loc 1 380 9 is_stmt 1 view .LVU330
 1208 00c4 FFF7FEFF 		bl	SDCARD_Unselect
 1209              	.LVL105:
 381:./FW/sdcard.c ****     }
 1210              		.loc 1 381 9 view .LVU331
 381:./FW/sdcard.c ****     }
 1211              		.loc 1 381 16 is_stmt 0 view .LVU332
 1212 00c8 6FF00200 		mvn	r0, #2
 1213 00cc EEE7     		b	.L97
 1214              	.L107:
 385:./FW/sdcard.c ****         return -4;
 1215              		.loc 1 385 9 is_stmt 1 view .LVU333
 1216 00ce FFF7FEFF 		bl	SDCARD_Unselect
 1217              	.LVL106:
 386:./FW/sdcard.c ****     }
 1218              		.loc 1 386 9 view .LVU334
 386:./FW/sdcard.c ****     }
 1219              		.loc 1 386 16 is_stmt 0 view .LVU335
 1220 00d2 6FF00300 		mvn	r0, #3
 1221 00d6 E9E7     		b	.L97
 1222              	.L109:
 1223              		.align	2
 1224              	.L108:
 1225 00d8 00000000 		.word	hspi1
 1226              		.cfi_endproc
 1227              	.LFE141:
 1229              		.section	.text.SDCARD_ReadBegin,"ax",%progbits
 1230              		.align	1
 1231              		.global	SDCARD_ReadBegin
 1232              		.syntax unified
 1233              		.thumb
 1234              		.thumb_func
 1235              		.fpu fpv4-sp-d16
 1237              	SDCARD_ReadBegin:
 1238              	.LVL107:
 1239              	.LFB142:
 392:./FW/sdcard.c **** 
 393:./FW/sdcard.c **** int SDCARD_ReadBegin(uint32_t blockNum) {
 1240              		.loc 1 393 41 is_stmt 1 view -0
 1241              		.cfi_startproc
 1242              		@ args = 0, pretend = 0, frame = 8
 1243              		@ frame_needed = 0, uses_anonymous_args = 0
 1244              		.loc 1 393 41 is_stmt 0 view .LVU337
 1245 0000 10B5     		push	{r4, lr}
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 32


 1246              	.LCFI30:
 1247              		.cfi_def_cfa_offset 8
 1248              		.cfi_offset 4, -8
 1249              		.cfi_offset 14, -4
 1250 0002 82B0     		sub	sp, sp, #8
 1251              	.LCFI31:
 1252              		.cfi_def_cfa_offset 16
 1253 0004 0446     		mov	r4, r0
 394:./FW/sdcard.c ****     SDCARD_Select();
 1254              		.loc 1 394 5 is_stmt 1 view .LVU338
 1255 0006 FFF7FEFF 		bl	SDCARD_Select
 1256              	.LVL108:
 395:./FW/sdcard.c **** 
 396:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) { // keep this!
 1257              		.loc 1 396 5 view .LVU339
 1258              		.loc 1 396 8 is_stmt 0 view .LVU340
 1259 000a FFF7FEFF 		bl	SDCARD_WaitNotBusy
 1260              	.LVL109:
 1261              		.loc 1 396 7 view .LVU341
 1262 000e 0028     		cmp	r0, #0
 1263 0010 1FDB     		blt	.L115
 397:./FW/sdcard.c ****         SDCARD_Unselect();
 398:./FW/sdcard.c ****         return -1;
 399:./FW/sdcard.c ****     }
 400:./FW/sdcard.c **** 
 401:./FW/sdcard.c ****     /* CMD18 (READ_MULTIPLE_BLOCK) command */
 402:./FW/sdcard.c ****     uint8_t cmd[] = {
 1264              		.loc 1 402 5 is_stmt 1 view .LVU342
 1265              		.loc 1 402 13 is_stmt 0 view .LVU343
 1266 0012 5223     		movs	r3, #82
 1267 0014 8DF80030 		strb	r3, [sp]
 403:./FW/sdcard.c ****         0x40 | 0x12 /* CMD18 */,
 404:./FW/sdcard.c ****         (blockNum >> 24) & 0xFF, /* ARG */
 1268              		.loc 1 404 19 view .LVU344
 1269 0018 230E     		lsrs	r3, r4, #24
 402:./FW/sdcard.c ****         0x40 | 0x12 /* CMD18 */,
 1270              		.loc 1 402 13 view .LVU345
 1271 001a 8DF80130 		strb	r3, [sp, #1]
 405:./FW/sdcard.c ****         (blockNum >> 16) & 0xFF,
 1272              		.loc 1 405 19 view .LVU346
 1273 001e 230C     		lsrs	r3, r4, #16
 402:./FW/sdcard.c ****         0x40 | 0x12 /* CMD18 */,
 1274              		.loc 1 402 13 view .LVU347
 1275 0020 8DF80230 		strb	r3, [sp, #2]
 406:./FW/sdcard.c ****         (blockNum >> 8) & 0xFF,
 1276              		.loc 1 406 19 view .LVU348
 1277 0024 230A     		lsrs	r3, r4, #8
 402:./FW/sdcard.c ****         0x40 | 0x12 /* CMD18 */,
 1278              		.loc 1 402 13 view .LVU349
 1279 0026 8DF80330 		strb	r3, [sp, #3]
 1280 002a 8DF80440 		strb	r4, [sp, #4]
 1281 002e FF23     		movs	r3, #255
 1282 0030 8DF80530 		strb	r3, [sp, #5]
 407:./FW/sdcard.c ****         blockNum & 0xFF,
 408:./FW/sdcard.c ****         (0x7F << 1) | 1 /* CRC7 + end bit */
 409:./FW/sdcard.c ****     };
 410:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 33


 1283              		.loc 1 410 5 is_stmt 1 view .LVU350
 1284 0034 4FF0FF33 		mov	r3, #-1
 1285 0038 0622     		movs	r2, #6
 1286 003a 6946     		mov	r1, sp
 1287 003c 0A48     		ldr	r0, .L117
 1288 003e FFF7FEFF 		bl	HAL_SPI_Transmit
 1289              	.LVL110:
 411:./FW/sdcard.c **** 
 412:./FW/sdcard.c ****     if(SDCARD_ReadR1() != 0x00) {
 1290              		.loc 1 412 5 view .LVU351
 1291              		.loc 1 412 8 is_stmt 0 view .LVU352
 1292 0042 FFF7FEFF 		bl	SDCARD_ReadR1
 1293              	.LVL111:
 1294              		.loc 1 412 7 view .LVU353
 1295 0046 48B9     		cbnz	r0, .L116
 413:./FW/sdcard.c ****         SDCARD_Unselect();
 414:./FW/sdcard.c ****         return -2;
 415:./FW/sdcard.c ****     }
 416:./FW/sdcard.c **** 
 417:./FW/sdcard.c ****     SDCARD_Unselect();
 1296              		.loc 1 417 5 is_stmt 1 view .LVU354
 1297 0048 FFF7FEFF 		bl	SDCARD_Unselect
 1298              	.LVL112:
 418:./FW/sdcard.c ****     return 0;
 1299              		.loc 1 418 5 view .LVU355
 1300              		.loc 1 418 12 is_stmt 0 view .LVU356
 1301 004c 0020     		movs	r0, #0
 1302              	.L110:
 419:./FW/sdcard.c **** }
 1303              		.loc 1 419 1 view .LVU357
 1304 004e 02B0     		add	sp, sp, #8
 1305              	.LCFI32:
 1306              		.cfi_remember_state
 1307              		.cfi_def_cfa_offset 8
 1308              		@ sp needed
 1309 0050 10BD     		pop	{r4, pc}
 1310              	.LVL113:
 1311              	.L115:
 1312              	.LCFI33:
 1313              		.cfi_restore_state
 397:./FW/sdcard.c ****         return -1;
 1314              		.loc 1 397 9 is_stmt 1 view .LVU358
 1315 0052 FFF7FEFF 		bl	SDCARD_Unselect
 1316              	.LVL114:
 398:./FW/sdcard.c ****     }
 1317              		.loc 1 398 9 view .LVU359
 398:./FW/sdcard.c ****     }
 1318              		.loc 1 398 16 is_stmt 0 view .LVU360
 1319 0056 4FF0FF30 		mov	r0, #-1
 1320 005a F8E7     		b	.L110
 1321              	.L116:
 413:./FW/sdcard.c ****         return -2;
 1322              		.loc 1 413 9 is_stmt 1 view .LVU361
 1323 005c FFF7FEFF 		bl	SDCARD_Unselect
 1324              	.LVL115:
 414:./FW/sdcard.c ****     }
 1325              		.loc 1 414 9 view .LVU362
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 34


 414:./FW/sdcard.c ****     }
 1326              		.loc 1 414 16 is_stmt 0 view .LVU363
 1327 0060 6FF00100 		mvn	r0, #1
 1328 0064 F3E7     		b	.L110
 1329              	.L118:
 1330 0066 00BF     		.align	2
 1331              	.L117:
 1332 0068 00000000 		.word	hspi1
 1333              		.cfi_endproc
 1334              	.LFE142:
 1336              		.section	.text.SDCARD_ReadData,"ax",%progbits
 1337              		.align	1
 1338              		.global	SDCARD_ReadData
 1339              		.syntax unified
 1340              		.thumb
 1341              		.thumb_func
 1342              		.fpu fpv4-sp-d16
 1344              	SDCARD_ReadData:
 1345              	.LVL116:
 1346              	.LFB143:
 420:./FW/sdcard.c **** 
 421:./FW/sdcard.c **** int SDCARD_ReadData(uint8_t* buff) {
 1347              		.loc 1 421 36 is_stmt 1 view -0
 1348              		.cfi_startproc
 1349              		@ args = 0, pretend = 0, frame = 8
 1350              		@ frame_needed = 0, uses_anonymous_args = 0
 1351              		.loc 1 421 36 is_stmt 0 view .LVU365
 1352 0000 10B5     		push	{r4, lr}
 1353              	.LCFI34:
 1354              		.cfi_def_cfa_offset 8
 1355              		.cfi_offset 4, -8
 1356              		.cfi_offset 14, -4
 1357 0002 82B0     		sub	sp, sp, #8
 1358              	.LCFI35:
 1359              		.cfi_def_cfa_offset 16
 1360 0004 0446     		mov	r4, r0
 422:./FW/sdcard.c ****     uint8_t crc[2];
 1361              		.loc 1 422 5 is_stmt 1 view .LVU366
 423:./FW/sdcard.c ****     SDCARD_Select();
 1362              		.loc 1 423 5 view .LVU367
 1363 0006 FFF7FEFF 		bl	SDCARD_Select
 1364              	.LVL117:
 424:./FW/sdcard.c **** 
 425:./FW/sdcard.c ****     if(SDCARD_WaitDataToken(DATA_TOKEN_CMD18) < 0) {
 1365              		.loc 1 425 5 view .LVU368
 1366              		.loc 1 425 8 is_stmt 0 view .LVU369
 1367 000a FE20     		movs	r0, #254
 1368 000c FFF7FEFF 		bl	SDCARD_WaitDataToken
 1369              	.LVL118:
 1370              		.loc 1 425 7 view .LVU370
 1371 0010 0028     		cmp	r0, #0
 1372 0012 11DB     		blt	.L125
 426:./FW/sdcard.c ****         SDCARD_Unselect();
 427:./FW/sdcard.c ****         return -1;
 428:./FW/sdcard.c ****     }
 429:./FW/sdcard.c **** 
 430:./FW/sdcard.c ****     if(SDCARD_ReadBytes(buff, 512) < 0) {
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 35


 1373              		.loc 1 430 5 is_stmt 1 view .LVU371
 1374              		.loc 1 430 8 is_stmt 0 view .LVU372
 1375 0014 4FF40071 		mov	r1, #512
 1376 0018 2046     		mov	r0, r4
 1377 001a FFF7FEFF 		bl	SDCARD_ReadBytes
 1378              	.LVL119:
 1379              		.loc 1 430 7 view .LVU373
 1380 001e 0028     		cmp	r0, #0
 1381 0020 0FDB     		blt	.L126
 431:./FW/sdcard.c ****         SDCARD_Unselect();
 432:./FW/sdcard.c ****         return -2;
 433:./FW/sdcard.c ****     }
 434:./FW/sdcard.c **** 
 435:./FW/sdcard.c ****     if(SDCARD_ReadBytes(crc, 2) < 0) {
 1382              		.loc 1 435 5 is_stmt 1 view .LVU374
 1383              		.loc 1 435 8 is_stmt 0 view .LVU375
 1384 0022 0221     		movs	r1, #2
 1385 0024 01A8     		add	r0, sp, #4
 1386 0026 FFF7FEFF 		bl	SDCARD_ReadBytes
 1387              	.LVL120:
 1388              		.loc 1 435 7 view .LVU376
 1389 002a 0028     		cmp	r0, #0
 1390 002c 0EDB     		blt	.L127
 436:./FW/sdcard.c ****         SDCARD_Unselect();
 437:./FW/sdcard.c ****         return -3;
 438:./FW/sdcard.c ****     }
 439:./FW/sdcard.c **** 
 440:./FW/sdcard.c ****     SDCARD_Unselect();
 1391              		.loc 1 440 5 is_stmt 1 view .LVU377
 1392 002e FFF7FEFF 		bl	SDCARD_Unselect
 1393              	.LVL121:
 441:./FW/sdcard.c ****     return 0;
 1394              		.loc 1 441 5 view .LVU378
 1395              		.loc 1 441 12 is_stmt 0 view .LVU379
 1396 0032 0020     		movs	r0, #0
 1397              	.L119:
 442:./FW/sdcard.c **** 
 443:./FW/sdcard.c **** }
 1398              		.loc 1 443 1 view .LVU380
 1399 0034 02B0     		add	sp, sp, #8
 1400              	.LCFI36:
 1401              		.cfi_remember_state
 1402              		.cfi_def_cfa_offset 8
 1403              		@ sp needed
 1404 0036 10BD     		pop	{r4, pc}
 1405              	.LVL122:
 1406              	.L125:
 1407              	.LCFI37:
 1408              		.cfi_restore_state
 426:./FW/sdcard.c ****         return -1;
 1409              		.loc 1 426 9 is_stmt 1 view .LVU381
 1410 0038 FFF7FEFF 		bl	SDCARD_Unselect
 1411              	.LVL123:
 427:./FW/sdcard.c ****     }
 1412              		.loc 1 427 9 view .LVU382
 427:./FW/sdcard.c ****     }
 1413              		.loc 1 427 16 is_stmt 0 view .LVU383
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 36


 1414 003c 4FF0FF30 		mov	r0, #-1
 1415 0040 F8E7     		b	.L119
 1416              	.L126:
 431:./FW/sdcard.c ****         return -2;
 1417              		.loc 1 431 9 is_stmt 1 view .LVU384
 1418 0042 FFF7FEFF 		bl	SDCARD_Unselect
 1419              	.LVL124:
 432:./FW/sdcard.c ****     }
 1420              		.loc 1 432 9 view .LVU385
 432:./FW/sdcard.c ****     }
 1421              		.loc 1 432 16 is_stmt 0 view .LVU386
 1422 0046 6FF00100 		mvn	r0, #1
 1423 004a F3E7     		b	.L119
 1424              	.L127:
 436:./FW/sdcard.c ****         return -3;
 1425              		.loc 1 436 9 is_stmt 1 view .LVU387
 1426 004c FFF7FEFF 		bl	SDCARD_Unselect
 1427              	.LVL125:
 437:./FW/sdcard.c ****     }
 1428              		.loc 1 437 9 view .LVU388
 437:./FW/sdcard.c ****     }
 1429              		.loc 1 437 16 is_stmt 0 view .LVU389
 1430 0050 6FF00200 		mvn	r0, #2
 1431 0054 EEE7     		b	.L119
 1432              		.cfi_endproc
 1433              	.LFE143:
 1435              		.section	.text.SDCARD_ReadEnd,"ax",%progbits
 1436              		.align	1
 1437              		.global	SDCARD_ReadEnd
 1438              		.syntax unified
 1439              		.thumb
 1440              		.thumb_func
 1441              		.fpu fpv4-sp-d16
 1443              	SDCARD_ReadEnd:
 1444              	.LFB144:
 444:./FW/sdcard.c **** 
 445:./FW/sdcard.c **** int SDCARD_ReadEnd() {
 1445              		.loc 1 445 22 is_stmt 1 view -0
 1446              		.cfi_startproc
 1447              		@ args = 0, pretend = 0, frame = 8
 1448              		@ frame_needed = 0, uses_anonymous_args = 0
 1449 0000 00B5     		push	{lr}
 1450              	.LCFI38:
 1451              		.cfi_def_cfa_offset 4
 1452              		.cfi_offset 14, -4
 1453 0002 83B0     		sub	sp, sp, #12
 1454              	.LCFI39:
 1455              		.cfi_def_cfa_offset 16
 446:./FW/sdcard.c ****     SDCARD_Select();
 1456              		.loc 1 446 5 view .LVU391
 1457 0004 FFF7FEFF 		bl	SDCARD_Select
 1458              	.LVL126:
 1459              	.LBB14:
 447:./FW/sdcard.c **** 
 448:./FW/sdcard.c ****     /* CMD12 (STOP_TRANSMISSION) */
 449:./FW/sdcard.c ****     {
 450:./FW/sdcard.c ****         static const uint8_t cmd[] = { 0x40 | 0x0C /* CMD12 */, 0x00, 0x00, 0x00, 0x00 /* ARG */, (
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 37


 1460              		.loc 1 450 9 view .LVU392
 451:./FW/sdcard.c ****         HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 1461              		.loc 1 451 9 view .LVU393
 1462 0008 4FF0FF33 		mov	r3, #-1
 1463 000c 0622     		movs	r2, #6
 1464 000e 0F49     		ldr	r1, .L135
 1465 0010 0F48     		ldr	r0, .L135+4
 1466 0012 FFF7FEFF 		bl	HAL_SPI_Transmit
 1467              	.LVL127:
 1468              	.LBE14:
 452:./FW/sdcard.c ****     }
 453:./FW/sdcard.c **** 
 454:./FW/sdcard.c ****     /*
 455:./FW/sdcard.c ****     The received byte immediataly following CMD12 is a stuff byte, it should be
 456:./FW/sdcard.c ****     discarded before receive the response of the CMD12
 457:./FW/sdcard.c ****     */
 458:./FW/sdcard.c ****     uint8_t stuffByte;
 1469              		.loc 1 458 5 view .LVU394
 459:./FW/sdcard.c ****     if(SDCARD_ReadBytes(&stuffByte, sizeof(stuffByte)) < 0) {
 1470              		.loc 1 459 5 view .LVU395
 1471              		.loc 1 459 8 is_stmt 0 view .LVU396
 1472 0016 0121     		movs	r1, #1
 1473 0018 0DF10700 		add	r0, sp, #7
 1474 001c FFF7FEFF 		bl	SDCARD_ReadBytes
 1475              	.LVL128:
 1476              		.loc 1 459 7 view .LVU397
 1477 0020 0028     		cmp	r0, #0
 1478 0022 08DB     		blt	.L133
 460:./FW/sdcard.c ****         SDCARD_Unselect();
 461:./FW/sdcard.c ****         return -1;
 462:./FW/sdcard.c ****     }
 463:./FW/sdcard.c **** 
 464:./FW/sdcard.c ****     if(SDCARD_ReadR1() != 0x00) {
 1479              		.loc 1 464 5 is_stmt 1 view .LVU398
 1480              		.loc 1 464 8 is_stmt 0 view .LVU399
 1481 0024 FFF7FEFF 		bl	SDCARD_ReadR1
 1482              	.LVL129:
 1483              		.loc 1 464 7 view .LVU400
 1484 0028 50B9     		cbnz	r0, .L134
 465:./FW/sdcard.c ****         SDCARD_Unselect();
 466:./FW/sdcard.c ****         return -2;
 467:./FW/sdcard.c ****     }
 468:./FW/sdcard.c **** 
 469:./FW/sdcard.c ****     SDCARD_Unselect();
 1485              		.loc 1 469 5 is_stmt 1 view .LVU401
 1486 002a FFF7FEFF 		bl	SDCARD_Unselect
 1487              	.LVL130:
 470:./FW/sdcard.c ****     return 0;
 1488              		.loc 1 470 5 view .LVU402
 1489              		.loc 1 470 12 is_stmt 0 view .LVU403
 1490 002e 0020     		movs	r0, #0
 1491              	.L128:
 471:./FW/sdcard.c **** }
 1492              		.loc 1 471 1 view .LVU404
 1493 0030 03B0     		add	sp, sp, #12
 1494              	.LCFI40:
 1495              		.cfi_remember_state
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 38


 1496              		.cfi_def_cfa_offset 4
 1497              		@ sp needed
 1498 0032 5DF804FB 		ldr	pc, [sp], #4
 1499              	.L133:
 1500              	.LCFI41:
 1501              		.cfi_restore_state
 460:./FW/sdcard.c ****         return -1;
 1502              		.loc 1 460 9 is_stmt 1 view .LVU405
 1503 0036 FFF7FEFF 		bl	SDCARD_Unselect
 1504              	.LVL131:
 461:./FW/sdcard.c ****     }
 1505              		.loc 1 461 9 view .LVU406
 461:./FW/sdcard.c ****     }
 1506              		.loc 1 461 16 is_stmt 0 view .LVU407
 1507 003a 4FF0FF30 		mov	r0, #-1
 1508 003e F7E7     		b	.L128
 1509              	.L134:
 465:./FW/sdcard.c ****         return -2;
 1510              		.loc 1 465 9 is_stmt 1 view .LVU408
 1511 0040 FFF7FEFF 		bl	SDCARD_Unselect
 1512              	.LVL132:
 466:./FW/sdcard.c ****     }
 1513              		.loc 1 466 9 view .LVU409
 466:./FW/sdcard.c ****     }
 1514              		.loc 1 466 16 is_stmt 0 view .LVU410
 1515 0044 6FF00100 		mvn	r0, #1
 1516 0048 F2E7     		b	.L128
 1517              	.L136:
 1518 004a 00BF     		.align	2
 1519              	.L135:
 1520 004c 00000000 		.word	.LANCHOR6
 1521 0050 00000000 		.word	hspi1
 1522              		.cfi_endproc
 1523              	.LFE144:
 1525              		.section	.text.SDCARD_WriteBegin,"ax",%progbits
 1526              		.align	1
 1527              		.global	SDCARD_WriteBegin
 1528              		.syntax unified
 1529              		.thumb
 1530              		.thumb_func
 1531              		.fpu fpv4-sp-d16
 1533              	SDCARD_WriteBegin:
 1534              	.LVL133:
 1535              	.LFB145:
 472:./FW/sdcard.c **** 
 473:./FW/sdcard.c **** 
 474:./FW/sdcard.c **** int SDCARD_WriteBegin(uint32_t blockNum) {
 1536              		.loc 1 474 42 is_stmt 1 view -0
 1537              		.cfi_startproc
 1538              		@ args = 0, pretend = 0, frame = 8
 1539              		@ frame_needed = 0, uses_anonymous_args = 0
 1540              		.loc 1 474 42 is_stmt 0 view .LVU412
 1541 0000 10B5     		push	{r4, lr}
 1542              	.LCFI42:
 1543              		.cfi_def_cfa_offset 8
 1544              		.cfi_offset 4, -8
 1545              		.cfi_offset 14, -4
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 39


 1546 0002 82B0     		sub	sp, sp, #8
 1547              	.LCFI43:
 1548              		.cfi_def_cfa_offset 16
 1549 0004 0446     		mov	r4, r0
 475:./FW/sdcard.c ****     SDCARD_Select();
 1550              		.loc 1 475 5 is_stmt 1 view .LVU413
 1551 0006 FFF7FEFF 		bl	SDCARD_Select
 1552              	.LVL134:
 476:./FW/sdcard.c **** 
 477:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) { // keep this!
 1553              		.loc 1 477 5 view .LVU414
 1554              		.loc 1 477 8 is_stmt 0 view .LVU415
 1555 000a FFF7FEFF 		bl	SDCARD_WaitNotBusy
 1556              	.LVL135:
 1557              		.loc 1 477 7 view .LVU416
 1558 000e 0028     		cmp	r0, #0
 1559 0010 1FDB     		blt	.L142
 478:./FW/sdcard.c ****         SDCARD_Unselect();
 479:./FW/sdcard.c ****         return -1;
 480:./FW/sdcard.c ****     }
 481:./FW/sdcard.c **** 
 482:./FW/sdcard.c ****     /* CMD25 (WRITE_MULTIPLE_BLOCK) command */
 483:./FW/sdcard.c ****     uint8_t cmd[] = {
 1560              		.loc 1 483 5 is_stmt 1 view .LVU417
 1561              		.loc 1 483 13 is_stmt 0 view .LVU418
 1562 0012 5923     		movs	r3, #89
 1563 0014 8DF80030 		strb	r3, [sp]
 484:./FW/sdcard.c ****         0x40 | 0x19 /* CMD25 */,
 485:./FW/sdcard.c ****         (blockNum >> 24) & 0xFF, /* ARG */
 1564              		.loc 1 485 19 view .LVU419
 1565 0018 230E     		lsrs	r3, r4, #24
 483:./FW/sdcard.c ****         0x40 | 0x19 /* CMD25 */,
 1566              		.loc 1 483 13 view .LVU420
 1567 001a 8DF80130 		strb	r3, [sp, #1]
 486:./FW/sdcard.c ****         (blockNum >> 16) & 0xFF,
 1568              		.loc 1 486 19 view .LVU421
 1569 001e 230C     		lsrs	r3, r4, #16
 483:./FW/sdcard.c ****         0x40 | 0x19 /* CMD25 */,
 1570              		.loc 1 483 13 view .LVU422
 1571 0020 8DF80230 		strb	r3, [sp, #2]
 487:./FW/sdcard.c ****         (blockNum >> 8) & 0xFF,
 1572              		.loc 1 487 19 view .LVU423
 1573 0024 230A     		lsrs	r3, r4, #8
 483:./FW/sdcard.c ****         0x40 | 0x19 /* CMD25 */,
 1574              		.loc 1 483 13 view .LVU424
 1575 0026 8DF80330 		strb	r3, [sp, #3]
 1576 002a 8DF80440 		strb	r4, [sp, #4]
 1577 002e FF23     		movs	r3, #255
 1578 0030 8DF80530 		strb	r3, [sp, #5]
 488:./FW/sdcard.c ****         blockNum & 0xFF,
 489:./FW/sdcard.c ****         (0x7F << 1) | 1 /* CRC7 + end bit */
 490:./FW/sdcard.c ****     };
 491:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)cmd, sizeof(cmd), HAL_MAX_DELAY);
 1579              		.loc 1 491 5 is_stmt 1 view .LVU425
 1580 0034 4FF0FF33 		mov	r3, #-1
 1581 0038 0622     		movs	r2, #6
 1582 003a 6946     		mov	r1, sp
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 40


 1583 003c 0A48     		ldr	r0, .L144
 1584 003e FFF7FEFF 		bl	HAL_SPI_Transmit
 1585              	.LVL136:
 492:./FW/sdcard.c **** 
 493:./FW/sdcard.c ****     if(SDCARD_ReadR1() != 0x00) {
 1586              		.loc 1 493 5 view .LVU426
 1587              		.loc 1 493 8 is_stmt 0 view .LVU427
 1588 0042 FFF7FEFF 		bl	SDCARD_ReadR1
 1589              	.LVL137:
 1590              		.loc 1 493 7 view .LVU428
 1591 0046 48B9     		cbnz	r0, .L143
 494:./FW/sdcard.c ****         SDCARD_Unselect();
 495:./FW/sdcard.c ****         return -2;
 496:./FW/sdcard.c ****     }
 497:./FW/sdcard.c **** 
 498:./FW/sdcard.c ****     SDCARD_Unselect();
 1592              		.loc 1 498 5 is_stmt 1 view .LVU429
 1593 0048 FFF7FEFF 		bl	SDCARD_Unselect
 1594              	.LVL138:
 499:./FW/sdcard.c ****     return 0;
 1595              		.loc 1 499 5 view .LVU430
 1596              		.loc 1 499 12 is_stmt 0 view .LVU431
 1597 004c 0020     		movs	r0, #0
 1598              	.L137:
 500:./FW/sdcard.c **** }
 1599              		.loc 1 500 1 view .LVU432
 1600 004e 02B0     		add	sp, sp, #8
 1601              	.LCFI44:
 1602              		.cfi_remember_state
 1603              		.cfi_def_cfa_offset 8
 1604              		@ sp needed
 1605 0050 10BD     		pop	{r4, pc}
 1606              	.LVL139:
 1607              	.L142:
 1608              	.LCFI45:
 1609              		.cfi_restore_state
 478:./FW/sdcard.c ****         return -1;
 1610              		.loc 1 478 9 is_stmt 1 view .LVU433
 1611 0052 FFF7FEFF 		bl	SDCARD_Unselect
 1612              	.LVL140:
 479:./FW/sdcard.c ****     }
 1613              		.loc 1 479 9 view .LVU434
 479:./FW/sdcard.c ****     }
 1614              		.loc 1 479 16 is_stmt 0 view .LVU435
 1615 0056 4FF0FF30 		mov	r0, #-1
 1616 005a F8E7     		b	.L137
 1617              	.L143:
 494:./FW/sdcard.c ****         return -2;
 1618              		.loc 1 494 9 is_stmt 1 view .LVU436
 1619 005c FFF7FEFF 		bl	SDCARD_Unselect
 1620              	.LVL141:
 495:./FW/sdcard.c ****     }
 1621              		.loc 1 495 9 view .LVU437
 495:./FW/sdcard.c ****     }
 1622              		.loc 1 495 16 is_stmt 0 view .LVU438
 1623 0060 6FF00100 		mvn	r0, #1
 1624 0064 F3E7     		b	.L137
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 41


 1625              	.L145:
 1626 0066 00BF     		.align	2
 1627              	.L144:
 1628 0068 00000000 		.word	hspi1
 1629              		.cfi_endproc
 1630              	.LFE145:
 1632              		.section	.text.SDCARD_WriteData,"ax",%progbits
 1633              		.align	1
 1634              		.global	SDCARD_WriteData
 1635              		.syntax unified
 1636              		.thumb
 1637              		.thumb_func
 1638              		.fpu fpv4-sp-d16
 1640              	SDCARD_WriteData:
 1641              	.LVL142:
 1642              	.LFB146:
 501:./FW/sdcard.c **** 
 502:./FW/sdcard.c **** int SDCARD_WriteData(const uint8_t* buff) {
 1643              		.loc 1 502 43 is_stmt 1 view -0
 1644              		.cfi_startproc
 1645              		@ args = 0, pretend = 0, frame = 8
 1646              		@ frame_needed = 0, uses_anonymous_args = 0
 1647              		.loc 1 502 43 is_stmt 0 view .LVU440
 1648 0000 30B5     		push	{r4, r5, lr}
 1649              	.LCFI46:
 1650              		.cfi_def_cfa_offset 12
 1651              		.cfi_offset 4, -12
 1652              		.cfi_offset 5, -8
 1653              		.cfi_offset 14, -4
 1654 0002 83B0     		sub	sp, sp, #12
 1655              	.LCFI47:
 1656              		.cfi_def_cfa_offset 24
 1657 0004 0546     		mov	r5, r0
 503:./FW/sdcard.c ****     SDCARD_Select();
 1658              		.loc 1 503 5 is_stmt 1 view .LVU441
 1659 0006 FFF7FEFF 		bl	SDCARD_Select
 1660              	.LVL143:
 504:./FW/sdcard.c **** 
 505:./FW/sdcard.c ****     uint8_t dataToken = DATA_TOKEN_CMD25;
 1661              		.loc 1 505 5 view .LVU442
 1662              		.loc 1 505 13 is_stmt 0 view .LVU443
 1663 000a FC23     		movs	r3, #252
 1664 000c 8DF80730 		strb	r3, [sp, #7]
 506:./FW/sdcard.c ****     uint8_t crc[2] = { 0xFF, 0xFF };
 1665              		.loc 1 506 5 is_stmt 1 view .LVU444
 1666              		.loc 1 506 13 is_stmt 0 view .LVU445
 1667 0010 4FF6FF73 		movw	r3, #65535
 1668 0014 ADF80430 		strh	r3, [sp, #4]	@ movhi
 507:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, &dataToken, sizeof(dataToken), HAL_MAX_DELAY);
 1669              		.loc 1 507 5 is_stmt 1 view .LVU446
 1670 0018 1A4C     		ldr	r4, .L153
 1671 001a 4FF0FF33 		mov	r3, #-1
 1672 001e 0122     		movs	r2, #1
 1673 0020 0DF10701 		add	r1, sp, #7
 1674 0024 2046     		mov	r0, r4
 1675 0026 FFF7FEFF 		bl	HAL_SPI_Transmit
 1676              	.LVL144:
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 42


 508:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, (uint8_t*)buff, 512, HAL_MAX_DELAY);
 1677              		.loc 1 508 5 view .LVU447
 1678 002a 4FF0FF33 		mov	r3, #-1
 1679 002e 4FF40072 		mov	r2, #512
 1680 0032 2946     		mov	r1, r5
 1681 0034 2046     		mov	r0, r4
 1682 0036 FFF7FEFF 		bl	HAL_SPI_Transmit
 1683              	.LVL145:
 509:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, crc, sizeof(crc), HAL_MAX_DELAY);
 1684              		.loc 1 509 5 view .LVU448
 1685 003a 4FF0FF33 		mov	r3, #-1
 1686 003e 0222     		movs	r2, #2
 1687 0040 01A9     		add	r1, sp, #4
 1688 0042 2046     		mov	r0, r4
 1689 0044 FFF7FEFF 		bl	HAL_SPI_Transmit
 1690              	.LVL146:
 510:./FW/sdcard.c **** 
 511:./FW/sdcard.c ****     /*
 512:./FW/sdcard.c ****         dataResp:
 513:./FW/sdcard.c ****         xxx0abc1
 514:./FW/sdcard.c ****             010 - Data accepted
 515:./FW/sdcard.c ****             101 - Data rejected due to CRC error
 516:./FW/sdcard.c ****             110 - Data rejected due to write error
 517:./FW/sdcard.c ****     */
 518:./FW/sdcard.c ****     uint8_t dataResp;
 1691              		.loc 1 518 5 view .LVU449
 519:./FW/sdcard.c ****     SDCARD_ReadBytes(&dataResp, sizeof(dataResp));
 1692              		.loc 1 519 5 view .LVU450
 1693 0048 0121     		movs	r1, #1
 1694 004a 0DF10300 		add	r0, sp, #3
 1695 004e FFF7FEFF 		bl	SDCARD_ReadBytes
 1696              	.LVL147:
 520:./FW/sdcard.c ****     if((dataResp & 0x1F) != 0x05) { // data rejected
 1697              		.loc 1 520 5 view .LVU451
 1698              		.loc 1 520 18 is_stmt 0 view .LVU452
 1699 0052 9DF80330 		ldrb	r3, [sp, #3]	@ zero_extendqisi2
 1700              		.loc 1 520 7 view .LVU453
 1701 0056 03F01F03 		and	r3, r3, #31
 1702 005a 052B     		cmp	r3, #5
 1703 005c 08D1     		bne	.L151
 521:./FW/sdcard.c ****         SDCARD_Unselect();
 522:./FW/sdcard.c ****         return -1;
 523:./FW/sdcard.c ****     }
 524:./FW/sdcard.c **** 
 525:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) {
 1704              		.loc 1 525 5 is_stmt 1 view .LVU454
 1705              		.loc 1 525 8 is_stmt 0 view .LVU455
 1706 005e FFF7FEFF 		bl	SDCARD_WaitNotBusy
 1707              	.LVL148:
 1708              		.loc 1 525 7 view .LVU456
 1709 0062 0028     		cmp	r0, #0
 1710 0064 09DB     		blt	.L152
 526:./FW/sdcard.c ****         SDCARD_Unselect();
 527:./FW/sdcard.c ****         return -2;
 528:./FW/sdcard.c ****     }
 529:./FW/sdcard.c **** 
 530:./FW/sdcard.c ****     SDCARD_Unselect();
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 43


 1711              		.loc 1 530 5 is_stmt 1 view .LVU457
 1712 0066 FFF7FEFF 		bl	SDCARD_Unselect
 1713              	.LVL149:
 531:./FW/sdcard.c ****     return 0;
 1714              		.loc 1 531 5 view .LVU458
 1715              		.loc 1 531 12 is_stmt 0 view .LVU459
 1716 006a 0020     		movs	r0, #0
 1717              	.L146:
 532:./FW/sdcard.c **** }
 1718              		.loc 1 532 1 view .LVU460
 1719 006c 03B0     		add	sp, sp, #12
 1720              	.LCFI48:
 1721              		.cfi_remember_state
 1722              		.cfi_def_cfa_offset 12
 1723              		@ sp needed
 1724 006e 30BD     		pop	{r4, r5, pc}
 1725              	.LVL150:
 1726              	.L151:
 1727              	.LCFI49:
 1728              		.cfi_restore_state
 521:./FW/sdcard.c ****         return -1;
 1729              		.loc 1 521 9 is_stmt 1 view .LVU461
 1730 0070 FFF7FEFF 		bl	SDCARD_Unselect
 1731              	.LVL151:
 522:./FW/sdcard.c ****     }
 1732              		.loc 1 522 9 view .LVU462
 522:./FW/sdcard.c ****     }
 1733              		.loc 1 522 16 is_stmt 0 view .LVU463
 1734 0074 4FF0FF30 		mov	r0, #-1
 1735 0078 F8E7     		b	.L146
 1736              	.L152:
 526:./FW/sdcard.c ****         return -2;
 1737              		.loc 1 526 9 is_stmt 1 view .LVU464
 1738 007a FFF7FEFF 		bl	SDCARD_Unselect
 1739              	.LVL152:
 527:./FW/sdcard.c ****     }
 1740              		.loc 1 527 9 view .LVU465
 527:./FW/sdcard.c ****     }
 1741              		.loc 1 527 16 is_stmt 0 view .LVU466
 1742 007e 6FF00100 		mvn	r0, #1
 1743 0082 F3E7     		b	.L146
 1744              	.L154:
 1745              		.align	2
 1746              	.L153:
 1747 0084 00000000 		.word	hspi1
 1748              		.cfi_endproc
 1749              	.LFE146:
 1751              		.section	.text.SDCARD_WriteEnd,"ax",%progbits
 1752              		.align	1
 1753              		.global	SDCARD_WriteEnd
 1754              		.syntax unified
 1755              		.thumb
 1756              		.thumb_func
 1757              		.fpu fpv4-sp-d16
 1759              	SDCARD_WriteEnd:
 1760              	.LFB147:
 533:./FW/sdcard.c **** 
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 44


 534:./FW/sdcard.c **** int SDCARD_WriteEnd() {
 1761              		.loc 1 534 23 is_stmt 1 view -0
 1762              		.cfi_startproc
 1763              		@ args = 0, pretend = 0, frame = 8
 1764              		@ frame_needed = 0, uses_anonymous_args = 0
 1765 0000 00B5     		push	{lr}
 1766              	.LCFI50:
 1767              		.cfi_def_cfa_offset 4
 1768              		.cfi_offset 14, -4
 1769 0002 83B0     		sub	sp, sp, #12
 1770              	.LCFI51:
 1771              		.cfi_def_cfa_offset 16
 535:./FW/sdcard.c ****     SDCARD_Select();
 1772              		.loc 1 535 5 view .LVU468
 1773 0004 FFF7FEFF 		bl	SDCARD_Select
 1774              	.LVL153:
 536:./FW/sdcard.c **** 
 537:./FW/sdcard.c ****     uint8_t stopTran = 0xFD; // stop transaction token for CMD25
 1775              		.loc 1 537 5 view .LVU469
 1776              		.loc 1 537 13 is_stmt 0 view .LVU470
 1777 0008 FD23     		movs	r3, #253
 1778 000a 8DF80730 		strb	r3, [sp, #7]
 538:./FW/sdcard.c ****     HAL_SPI_Transmit(&SDCARD_SPI_PORT, &stopTran, sizeof(stopTran), HAL_MAX_DELAY);
 1779              		.loc 1 538 5 is_stmt 1 view .LVU471
 1780 000e 4FF0FF33 		mov	r3, #-1
 1781 0012 0122     		movs	r2, #1
 1782 0014 0DF10701 		add	r1, sp, #7
 1783 0018 0B48     		ldr	r0, .L160
 1784 001a FFF7FEFF 		bl	HAL_SPI_Transmit
 1785              	.LVL154:
 539:./FW/sdcard.c **** 
 540:./FW/sdcard.c ****     // skip one byte before readyng "busy"
 541:./FW/sdcard.c ****     // this is required by the spec and is necessary for some real SD-cards!
 542:./FW/sdcard.c ****     uint8_t skipByte;
 1786              		.loc 1 542 5 view .LVU472
 543:./FW/sdcard.c ****     SDCARD_ReadBytes(&skipByte, sizeof(skipByte));
 1787              		.loc 1 543 5 view .LVU473
 1788 001e 0121     		movs	r1, #1
 1789 0020 0DF10600 		add	r0, sp, #6
 1790 0024 FFF7FEFF 		bl	SDCARD_ReadBytes
 1791              	.LVL155:
 544:./FW/sdcard.c **** 
 545:./FW/sdcard.c ****     if(SDCARD_WaitNotBusy() < 0) {
 1792              		.loc 1 545 5 view .LVU474
 1793              		.loc 1 545 8 is_stmt 0 view .LVU475
 1794 0028 FFF7FEFF 		bl	SDCARD_WaitNotBusy
 1795              	.LVL156:
 1796              		.loc 1 545 7 view .LVU476
 1797 002c 0028     		cmp	r0, #0
 1798 002e 05DB     		blt	.L159
 546:./FW/sdcard.c ****         SDCARD_Unselect();
 547:./FW/sdcard.c ****         return -1;
 548:./FW/sdcard.c ****     }
 549:./FW/sdcard.c **** 
 550:./FW/sdcard.c ****     SDCARD_Unselect();
 1799              		.loc 1 550 5 is_stmt 1 view .LVU477
 1800 0030 FFF7FEFF 		bl	SDCARD_Unselect
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 45


 1801              	.LVL157:
 551:./FW/sdcard.c ****     return 0;
 1802              		.loc 1 551 5 view .LVU478
 1803              		.loc 1 551 12 is_stmt 0 view .LVU479
 1804 0034 0020     		movs	r0, #0
 1805              	.L155:
 552:./FW/sdcard.c **** }
 1806              		.loc 1 552 1 view .LVU480
 1807 0036 03B0     		add	sp, sp, #12
 1808              	.LCFI52:
 1809              		.cfi_remember_state
 1810              		.cfi_def_cfa_offset 4
 1811              		@ sp needed
 1812 0038 5DF804FB 		ldr	pc, [sp], #4
 1813              	.L159:
 1814              	.LCFI53:
 1815              		.cfi_restore_state
 546:./FW/sdcard.c ****         SDCARD_Unselect();
 1816              		.loc 1 546 9 is_stmt 1 view .LVU481
 1817 003c FFF7FEFF 		bl	SDCARD_Unselect
 1818              	.LVL158:
 547:./FW/sdcard.c ****     }
 1819              		.loc 1 547 9 view .LVU482
 547:./FW/sdcard.c ****     }
 1820              		.loc 1 547 16 is_stmt 0 view .LVU483
 1821 0040 4FF0FF30 		mov	r0, #-1
 1822 0044 F7E7     		b	.L155
 1823              	.L161:
 1824 0046 00BF     		.align	2
 1825              	.L160:
 1826 0048 00000000 		.word	hspi1
 1827              		.cfi_endproc
 1828              	.LFE147:
 1830              		.section	.rodata.cmd.8120,"a"
 1831              		.align	2
 1832              		.set	.LANCHOR0,. + 0
 1835              	cmd.8120:
 1836 0000 40000000 		.ascii	"@\000\000\000\000\225"
 1836      0095
 1837              		.section	.rodata.cmd.8121,"a"
 1838              		.align	2
 1839              		.set	.LANCHOR1,. + 0
 1842              	cmd.8121:
 1843 0000 48000001 		.ascii	"H\000\000\001\252\207"
 1843      AA87
 1844              		.section	.rodata.cmd.8123,"a"
 1845              		.align	2
 1846              		.set	.LANCHOR2,. + 0
 1849              	cmd.8123:
 1850 0000 77000000 		.ascii	"w\000\000\000\000\377"
 1850      00FF
 1851              		.section	.rodata.cmd.8124,"a"
 1852              		.align	2
 1853              		.set	.LANCHOR3,. + 0
 1856              	cmd.8124:
 1857 0000 69400000 		.ascii	"i@\000\000\000\377"
 1857      00FF
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 46


 1858              		.section	.rodata.cmd.8128,"a"
 1859              		.align	2
 1860              		.set	.LANCHOR4,. + 0
 1863              	cmd.8128:
 1864 0000 7A000000 		.ascii	"z\000\000\000\000\377"
 1864      00FF
 1865              		.section	.rodata.cmd.8135,"a"
 1866              		.align	2
 1867              		.set	.LANCHOR5,. + 0
 1870              	cmd.8135:
 1871 0000 49000000 		.ascii	"I\000\000\000\000\377"
 1871      00FF
 1872              		.section	.rodata.cmd.8161,"a"
 1873              		.align	2
 1874              		.set	.LANCHOR6,. + 0
 1877              	cmd.8161:
 1878 0000 4C000000 		.ascii	"L\000\000\000\000\377"
 1878      00FF
 1879              		.text
 1880              	.Letext0:
 1881              		.file 2 "c:\\gnu_tools_arm_embedded\\9_2019_q4\\arm-none-eabi\\include\\machine\\_default_types.h"
 1882              		.file 3 "c:\\gnu_tools_arm_embedded\\9_2019_q4\\arm-none-eabi\\include\\sys\\_stdint.h"
 1883              		.file 4 "Drivers/CMSIS/Include/core_cm4.h"
 1884              		.file 5 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/system_stm32l4xx.h"
 1885              		.file 6 "Drivers/CMSIS/Device/ST/STM32L4xx/Include/stm32l432xx.h"
 1886              		.file 7 "c:\\gnu_tools_arm_embedded\\9_2019_q4\\lib\\gcc\\arm-none-eabi\\9.2.1\\include\\stddef.h"
 1887              		.file 8 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_def.h"
 1888              		.file 9 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_gpio.h"
 1889              		.file 10 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_dma.h"
 1890              		.file 11 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_flash.h"
 1891              		.file 12 "Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal_spi.h"
 1892              		.file 13 "./FW/../Drivers/STM32L4xx_HAL_Driver/Inc/stm32l4xx_hal.h"
 1893              		.file 14 "./FW/sdcard.h"
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 47


DEFINED SYMBOLS
                            *ABS*:00000000 sdcard.c
C:\cygwin64\tmp\ccjd2Lx5.s:18     .text.SDCARD_Select:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:25     .text.SDCARD_Select:00000000 SDCARD_Select
C:\cygwin64\tmp\ccjd2Lx5.s:49     .text.SDCARD_ReadR1:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:55     .text.SDCARD_ReadR1:00000000 SDCARD_ReadR1
C:\cygwin64\tmp\ccjd2Lx5.s:100    .text.SDCARD_ReadR1:00000034 $d
C:\cygwin64\tmp\ccjd2Lx5.s:105    .text.SDCARD_ReadBytes:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:111    .text.SDCARD_ReadBytes:00000000 SDCARD_ReadBytes
C:\cygwin64\tmp\ccjd2Lx5.s:172    .text.SDCARD_ReadBytes:00000030 $d
C:\cygwin64\tmp\ccjd2Lx5.s:177    .text.SDCARD_WaitNotBusy:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:183    .text.SDCARD_WaitNotBusy:00000000 SDCARD_WaitNotBusy
C:\cygwin64\tmp\ccjd2Lx5.s:231    .text.SDCARD_WaitDataToken:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:237    .text.SDCARD_WaitDataToken:00000000 SDCARD_WaitDataToken
C:\cygwin64\tmp\ccjd2Lx5.s:297    .text.SDCARD_WaitDataToken:0000003c $d
C:\cygwin64\tmp\ccjd2Lx5.s:302    .text.SDCARD_Unselect:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:309    .text.SDCARD_Unselect:00000000 SDCARD_Unselect
C:\cygwin64\tmp\ccjd2Lx5.s:332    .text.SDCARD_Init:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:339    .text.SDCARD_Init:00000000 SDCARD_Init
C:\cygwin64\tmp\ccjd2Lx5.s:698    .text.SDCARD_Init:00000190 $d
C:\cygwin64\tmp\ccjd2Lx5.s:708    .text.SDCARD_GetBlocksNumber:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:715    .text.SDCARD_GetBlocksNumber:00000000 SDCARD_GetBlocksNumber
C:\cygwin64\tmp\ccjd2Lx5.s:886    .text.SDCARD_GetBlocksNumber:000000b4 $d
C:\cygwin64\tmp\ccjd2Lx5.s:892    .text.SDCARD_ReadSingleBlock:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:899    .text.SDCARD_ReadSingleBlock:00000000 SDCARD_ReadSingleBlock
C:\cygwin64\tmp\ccjd2Lx5.s:1047   .text.SDCARD_ReadSingleBlock:000000ac $d
C:\cygwin64\tmp\ccjd2Lx5.s:1052   .text.SDCARD_WriteSingleBlock:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:1059   .text.SDCARD_WriteSingleBlock:00000000 SDCARD_WriteSingleBlock
C:\cygwin64\tmp\ccjd2Lx5.s:1225   .text.SDCARD_WriteSingleBlock:000000d8 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1230   .text.SDCARD_ReadBegin:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:1237   .text.SDCARD_ReadBegin:00000000 SDCARD_ReadBegin
C:\cygwin64\tmp\ccjd2Lx5.s:1332   .text.SDCARD_ReadBegin:00000068 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1337   .text.SDCARD_ReadData:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:1344   .text.SDCARD_ReadData:00000000 SDCARD_ReadData
C:\cygwin64\tmp\ccjd2Lx5.s:1436   .text.SDCARD_ReadEnd:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:1443   .text.SDCARD_ReadEnd:00000000 SDCARD_ReadEnd
C:\cygwin64\tmp\ccjd2Lx5.s:1520   .text.SDCARD_ReadEnd:0000004c $d
C:\cygwin64\tmp\ccjd2Lx5.s:1526   .text.SDCARD_WriteBegin:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:1533   .text.SDCARD_WriteBegin:00000000 SDCARD_WriteBegin
C:\cygwin64\tmp\ccjd2Lx5.s:1628   .text.SDCARD_WriteBegin:00000068 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1633   .text.SDCARD_WriteData:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:1640   .text.SDCARD_WriteData:00000000 SDCARD_WriteData
C:\cygwin64\tmp\ccjd2Lx5.s:1747   .text.SDCARD_WriteData:00000084 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1752   .text.SDCARD_WriteEnd:00000000 $t
C:\cygwin64\tmp\ccjd2Lx5.s:1759   .text.SDCARD_WriteEnd:00000000 SDCARD_WriteEnd
C:\cygwin64\tmp\ccjd2Lx5.s:1826   .text.SDCARD_WriteEnd:00000048 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1831   .rodata.cmd.8120:00000000 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1835   .rodata.cmd.8120:00000000 cmd.8120
C:\cygwin64\tmp\ccjd2Lx5.s:1838   .rodata.cmd.8121:00000000 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1842   .rodata.cmd.8121:00000000 cmd.8121
C:\cygwin64\tmp\ccjd2Lx5.s:1845   .rodata.cmd.8123:00000000 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1849   .rodata.cmd.8123:00000000 cmd.8123
C:\cygwin64\tmp\ccjd2Lx5.s:1852   .rodata.cmd.8124:00000000 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1856   .rodata.cmd.8124:00000000 cmd.8124
C:\cygwin64\tmp\ccjd2Lx5.s:1859   .rodata.cmd.8128:00000000 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1863   .rodata.cmd.8128:00000000 cmd.8128
C:\cygwin64\tmp\ccjd2Lx5.s:1866   .rodata.cmd.8135:00000000 $d
ARM GAS  C:\cygwin64\tmp\ccjd2Lx5.s 			page 48


C:\cygwin64\tmp\ccjd2Lx5.s:1870   .rodata.cmd.8135:00000000 cmd.8135
C:\cygwin64\tmp\ccjd2Lx5.s:1873   .rodata.cmd.8161:00000000 $d
C:\cygwin64\tmp\ccjd2Lx5.s:1877   .rodata.cmd.8161:00000000 cmd.8161

UNDEFINED SYMBOLS
HAL_GPIO_WritePin
HAL_SPI_TransmitReceive
hspi1
HAL_SPI_Transmit
